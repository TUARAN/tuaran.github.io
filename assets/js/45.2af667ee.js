(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{540:function(s,n,e){"use strict";e.r(n);var t=e(2),a=Object(t.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"源码上手"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#源码上手"}},[s._v("#")]),s._v(" 源码上手")]),s._v(" "),e("h3",{attrs:{id:"同时执行多个-npm-run"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#同时执行多个-npm-run"}},[s._v("#")]),s._v(" 同时执行多个 npm run")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('// 首先进行安装\nnpm install concurrently --save\n\n// 然后在 package.json 里面的 scripts 内部修改\n  "scripts": {\n    "dev": "webpack-dev-server --inline --progress --config build/webpack.dev.conf.js",\n    "start": "npm run dev",\n    "lint": "eslint --ext .js,.vue src",\n    "test": "node build/build.js test",\n    "prepub:hwt": "node build/build.js hwy_test",\n    "prepub:dxt": "node build/build.js dxy_test",\n    "build:hw": "node build/build.js hwy_pro",\n    "build:dx": "node build/build.js dxy_pro",\n    "all": "concurrently \\"node build/build.js hwy_test\\" \\"node build/build.js dxy_test\\"  \\"node build/build.js hwy_pro\\" \\"node build/build.js dxy_pro\\""\n  },\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("p",[s._v('显然，安装 concurrently 后，用 " 进行分割拼接命令即可。')]),s._v(" "),e("h3",{attrs:{id:"node-爬虫初识"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#node-爬虫初识"}},[s._v("#")]),s._v(" node 爬虫初识")]),s._v(" "),e("p",[s._v("先看一个node的爬虫，上手也非常简单，也很强大")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('const cheerio = require("cheerio");\nconst superagent = require("superagent");\nconst fs = require("fs");\nconst nodeSchedule = require("node-schedule");\nconst weiboURL = "https://s.weibo.com";\nconst hotSearchURL = weiboURL + "/top/summary?cate=realtimehot";\n\n/**\n * 获取热搜列表数据方法\n */\nfunction getHotSearchList() {\n  return new Promise((resolve, reject) => {\n    superagent.get(hotSearchURL, (err, res) => {\n      if (err) reject("request error");\n      const $ = cheerio.load(res.text);\n      let hotList = [];\n      $("#pl_top_realtimehot table tbody tr").each(function (index) {\n        if (index !== 0) {\n          const $td = $(this).children().eq(1);\n          const link = weiboURL + $td.find("a").attr("href");\n          const text = $td.find("a").text();\n          const hotValue = $td.find("span").text();\n          const icon = $td.find("img").attr("src")\n            ? "https:" + $td.find("img").attr("src")\n            : "";\n          hotList.push({\n            index,\n            link,\n            text,\n            hotValue,\n            icon,\n          });\n        }\n      });\n      hotList.length ? resolve(hotList) : reject("errer");\n    });\n  });\n}\n\n/**\n * 每分钟第30秒定时执行爬取任务\n */\nnodeSchedule.scheduleJob("30 * * * * *", async function () {\n  try {\n    const hotList = await getHotSearchList();\n    await fs.writeFileSync(\n      `${__dirname}/hotSearch.json`,\n      JSON.stringify(hotList),\n      "utf-8"\n    );\n    console.log("写入成功", Date.now());\n  } catch (error) {\n    console.error(error);\n  }\n});\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br")])]),e("h3",{attrs:{id:"十分钟入门一个-node-爬虫"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#十分钟入门一个-node-爬虫"}},[s._v("#")]),s._v(" 十分钟入门一个 Node 爬虫")]),s._v(" "),e("p",[s._v("直接上代码")]),s._v(" "),e("p",[s._v("可以很直观的看到三个重要的 npm 包：")]),s._v(" "),e("ol",[e("li",[s._v("superagent 负责页面数据下载")]),s._v(" "),e("li",[s._v("cheerio 负责页面数据解析（跟 jquery 类似操作 DOM）")]),s._v(" "),e("li",[s._v("fs 模块读/写")])]),s._v(" "),e("p",[s._v("这就是以下简单爬虫的核心要素")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("const superagent = require('superagent');\nconst cheerio = require('cheerio');\nconst fs = require('fs');\nconst reptileUrl = \"http://www.jianshu.com/\";\nfunction replaceText(text) {\n  return text.replace(/\\n/g, \"\").replace(/\\s/g, \"\");\n}\nsuperagent.get(reptileUrl).end(function (err, res) {\n    // 抛错拦截\n    if (err) {\n        return throw Error(err);\n    }\n    // 解析数据\n    let $ = cheerio.load(res.text);\n    /**\n     * 存放数据容器\n     * @type {Array}\n     */\n    let data = [];\n    // 获取数据\n    $('#list-container .note-list li').each(function (i, elem) {\n        let _this = $(elem);\n        data.push({\n            id: _this.attr('data-note-id'),\n            slug: _this.find('.title').attr('href').replace(/\\/p\\//, \"\"),\n            author: {\n                slug: _this.find('.avatar').attr('href').replace(/\\/u\\//, \"\"),\n                avatar: _this.find('.avatar img').attr('src'),\n                nickname: replaceText(_this.find('.blue-link').text()),\n                sharedTime: _this.find('.time').attr('data-shared-at')\n            },\n            title: replaceText(_this.find('.title').text()),\n            abstract: replaceText(_this.find('.abstract').text()),\n            thumbnails: _this.find('.wrap-img img').attr('src'),\n            collection_tag: replaceText(_this.find('.collection-tag').text()),\n            reads_count: replaceText(_this.find('.ic-list-read').parent().text()) * 1,\n            comments_count: replaceText(_this.find('.ic-list-comments').parent().text()) * 1,\n            likes_count: replaceText(_this.find('.ic-list-like').parent().text()) * 1\n        });\n    });\n   // 生成数据\n    // 写入数据, 文件不存在会自动创建\n    fs.writeFile(__dirname + '/data/article.json', JSON.stringify({\n        status: 0,\n        data: data\n    }), function (err) {\n        if (err) throw err;\n        console.log('写入完成');\n    });\n});\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br")])])])}),[],!1,null,null,null);n.default=a.exports}}]);