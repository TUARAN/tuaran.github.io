(window.webpackJsonp=window.webpackJsonp||[]).push([[135],{632:function(n,e,s){"use strict";s.r(e);var a=s(2),t=Object(a.a)({},(function(){var n=this,e=n.$createElement,s=n._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("blockquote",[s("p",[n._v("é¦–å‘åœ¨æˆ‘çš„åšå®¢ "),s("a",{attrs:{href:"https://tuaran.github.io/views/2021/vue3vdom.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("æ·±å…¥ Vue3 è™šæ‹Ÿ DOM"),s("OutboundLink")],1)]),n._v(" "),s("p",[n._v("è¯‘è‡ªï¼š"),s("a",{attrs:{href:"https://medium.com/js-dojo/diving-into-the-vue-3s-virtual-dom-a6b4744032ec",target:"_blank",rel:"noopener noreferrer"}},[n._v("diving-into-the-vue-3s-virtual-dom-medium"),s("OutboundLink")],1)]),n._v(" "),s("p",[n._v("ä½œè€…ï¼š"),s("a",{attrs:{href:"https://medium.com/@lachlanmiller_52885",target:"_blank",rel:"noopener noreferrer"}},[n._v("Lachlan Miller"),s("OutboundLink")],1)])]),n._v(" "),s("h2",{attrs:{id:"åºè¨€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åºè¨€"}},[n._v("#")]),n._v(" åºè¨€")]),n._v(" "),s("p",[n._v("æ­¤ç¯‡æˆ‘ä»¬å°†æ·±å…¥ Vue3 è™šæ‹Ÿ DOMï¼Œä»¥åŠäº†è§£å®ƒæ˜¯å¦‚ä½•éå†æ‰¾åˆ°å¯¹åº” vnode çš„ã€‚")]),n._v(" "),s("p",[n._v("å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬ä¸éœ€è¦è€ƒè™‘ Vue ç»„ä»¶å†…éƒ¨æ˜¯å¦‚ä½•æ„æˆçš„ã€‚ä½†æœ‰ä¸€äº›åº“ä¼šå¸®åŠ©æˆ‘ä»¬ç†è§£ï¼Œæ¯”å¦‚ Vue Test Utils çš„ "),s("strong",[n._v("findComponent å‡½æ•°")]),n._v("ã€‚è¿˜æœ‰ä¸€ä¸ªæˆ‘ä»¬éƒ½åº”è¯¥å¾ˆç†Ÿæ‚‰çš„ Vue å¼€å‘å·¥å…· â€”â€” Vue DevToolsï¼Œå®ƒæ˜¾ç¤ºäº†åº”ç”¨çš„ç»„ä»¶å±‚æ¬¡ç»“æ„ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥å¯¹å®ƒè¿›è¡Œç¼–è¾‘æ“ä½œç­‰ã€‚")]),n._v(" "),s("p",[s("img",{attrs:{src:"/assets/img/2021/vue3dom/vuedevtool.png",alt:""}})]),n._v(" "),s("p",[n._v("æˆ‘ä»¬æœ¬ç¯‡è¦åšçš„æ˜¯ï¼šå®ç° Vue Test Utils API çš„ä¸€éƒ¨åˆ†ï¼Œå³ "),s("code",[n._v("findComponent")]),n._v(" å‡½æ•°ã€‚")]),n._v(" "),s("h2",{attrs:{id:"è®¾è®¡-findcomponent"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è®¾è®¡-findcomponent"}},[n._v("#")]),n._v(" è®¾è®¡ findComponent")]),n._v(" "),s("p",[n._v("é¦–å…ˆï¼Œæˆ‘ä»¬éƒ½çŸ¥é“"),s("strong",[n._v("è™šæ‹Ÿ DOM")]),n._v(" æ˜¯åŸºäºâ€œæå‡æ€§èƒ½â€æå‡ºçš„ï¼Œå½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒVue ä¼šåˆ¤æ–­æ­¤æ˜¯å¦éœ€è¦è¿›è¡Œæ›´æ–°ã€æˆ–è¿›è¡Œè¡¨è¾¾å¼çš„è®¡ç®—ã€æˆ–è¿›è¡Œæœ€ç»ˆçš„ DOM æ›´æ–°ã€‚")]),n._v(" "),s("p",[n._v("æ¯”å¦‚è¿™æ ·ï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("- div \n  - span (show: true) \n    - 'Visible'\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br")])]),s("p",[n._v("å®ƒçš„å†…éƒ¨å±‚æ¬¡å…³ç³»æ˜¯ï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("HTMLDivElement -> HTMLSpanElement -> TextNode\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br")])]),s("p",[n._v("å¦‚æœ "),s("code",[n._v("show")]),n._v(" å±æ€§å˜æˆ "),s("code",[n._v("false")]),n._v("ã€‚Vue è™šæ‹Ÿ DOM ä¼šè¿›è¡Œå¦‚ä¸‹æ›´æ–°ï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("- div \n  - span (show: false) \n    - 'Visible'\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br")])]),s("p",[n._v("æ¥ç€ï¼ŒVue ä¼šæ›´æ–° DOMï¼Œç§»é™¤"),s("code",[n._v("'span'")]),n._v(" å…ƒç´ ã€‚")]),n._v(" "),s("p",[n._v("é‚£ä¹ˆï¼Œæˆ‘ä»¬è®¾æƒ³ä¸€ä¸‹ï¼Œ"),s("code",[n._v("findComponent")]),n._v(" å‡½æ•°ï¼Œå®ƒçš„è°ƒç”¨å¯èƒ½ä¼šæ˜¯ç±»ä¼¼è¿™æ ·çš„ç»“æ„ï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("const { createApp } = require('vue')\n\nconst App = {\n  template: `\n    <C>\n      <B>\n        <A />\n      </B>\n    </C>\n  `\n}\n\nconst app = createApp(App).mount('#app')\n\nconst component = findComponent(A, { within: app })\n\n// æˆ‘ä»¬é€šè¿‡ findComponent æ–¹æ³•æ‰¾åˆ°äº† <A/> æ ‡ç­¾ã€‚\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br")])]),s("h2",{attrs:{id:"æ‰“å°-findcomponent"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ‰“å°-findcomponent"}},[n._v("#")]),n._v(" æ‰“å° findComponent")]),n._v(" "),s("p",[n._v("æ¥ç€ï¼Œæˆ‘ä»¬å…ˆå†™å‡ ä¸ªç®€å•ç»„ä»¶ï¼Œå¦‚ä¸‹ï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("// import jsdom-global. We need a global `document` for this to work.\nrequire('jsdom-global')()\nconst { createApp, h } = require('vue')\n\n// some components\nconst A = { \n  name: 'A',\n  data() {\n    return { msg: 'msg' }\n  },\n  render() {\n    return h('div', 'A')\n  }\n}\n\nconst B = { \n  name: 'B',\n  render() {\n    return h('span', h(A))\n  }\n}\n\nconst C = { \n  name: 'C',\n  data() {\n    return { foo: 'bar' }\n  },\n  render() {\n    return h('p', { id: 'a', foo: this.foo }, h(B))\n  }\n}\n\n// mount the app!\nconst app = createApp(C).mount(document.createElement('div'))\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br"),s("span",{staticClass:"line-number"},[n._v("18")]),s("br"),s("span",{staticClass:"line-number"},[n._v("19")]),s("br"),s("span",{staticClass:"line-number"},[n._v("20")]),s("br"),s("span",{staticClass:"line-number"},[n._v("21")]),s("br"),s("span",{staticClass:"line-number"},[n._v("22")]),s("br"),s("span",{staticClass:"line-number"},[n._v("23")]),s("br"),s("span",{staticClass:"line-number"},[n._v("24")]),s("br"),s("span",{staticClass:"line-number"},[n._v("25")]),s("br"),s("span",{staticClass:"line-number"},[n._v("26")]),s("br"),s("span",{staticClass:"line-number"},[n._v("27")]),s("br"),s("span",{staticClass:"line-number"},[n._v("28")]),s("br"),s("span",{staticClass:"line-number"},[n._v("29")]),s("br"),s("span",{staticClass:"line-number"},[n._v("30")]),s("br"),s("span",{staticClass:"line-number"},[n._v("31")]),s("br"),s("span",{staticClass:"line-number"},[n._v("32")]),s("br"),s("span",{staticClass:"line-number"},[n._v("33")]),s("br"),s("span",{staticClass:"line-number"},[n._v("34")]),s("br")])]),s("ul",[s("li",[n._v("æˆ‘ä»¬éœ€è¦åœ¨ Node.js v14+ ç¯å¢ƒï¼Œå› ä¸ºæˆ‘ä»¬è¦ç”¨åˆ° "),s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Optional_chaining",target:"_blank",rel:"noopener noreferrer"}},[n._v("å¯é€‰é“¾"),s("OutboundLink")],1),n._v("ã€‚ä¸”éœ€è¦å®‰è£… Vueã€jsdom å’Œ jsdom-globalã€‚")])]),n._v(" "),s("p",[n._v("æˆ‘ä»¬å¯ä»¥çœ‹åˆ° A , B , C ä¸‰ä¸ªç»„ä»¶ï¼Œå…¶ä¸­ A , C ç»„ä»¶æœ‰ data å±æ€§ï¼Œå®ƒä¼šå¸®åŠ©æˆ‘ä»¬æ·±å…¥ç ”ç©¶ VDOMã€‚")]),n._v(" "),s("p",[n._v("ä½ å¯ä»¥æ‰“å°è¯•è¯•ï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("console.log(app)\nconsole.log(Object.keys(app))\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br")])]),s("p",[n._v("ç»“æœä¸º "),s("code",[n._v("{}")]),n._v("ï¼Œå› ä¸º "),s("code",[n._v("Object.keys")]),n._v(" åªä¼šæ˜¾ç¤ºå¯æšä¸¾çš„å±æ€§ã€‚")]),n._v(" "),s("p",[n._v("æˆ‘ä»¬å¯ä»¥å°è¯•æ‰“å°"),s("strong",[n._v("éšè—çš„ä¸å¯æšä¸¾çš„å±æ€§")]),n._v("ï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("console.log(app.$)\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br")])]),s("p",[n._v("å¯ä»¥å¾—åˆ°å¤§é‡è¾“å‡ºä¿¡æ¯ï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("<ref *1> { \n  uid: 0, \n  vnode: {\n    __v_isVNode: true, \n    __v_skip: true, \n    type: { \n      name: 'C', \n      data: [Function: data], \n      render: [Function: render], \n      __props: [] \n  }, // hundreds of lines ...\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br")])]),s("p",[n._v("å†æ‰“å°ï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("console.log(Object.keys(app.$))\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br")])]),s("p",[n._v("è¾“å‡ºï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("Press ENTER or type command to continue \n[ \n'uid', 'vnode', 'type', 'parent', 'appContext', 'root', 'next', 'subTree', 'update', 'render', 'proxy', 'withProxy', 'effects', 'provides', 'accessCache', 'renderCache', 'ctx', 'data', 'props', 'attrs', 'slots', 'refs', 'setupState', 'setupContext', 'suspense', 'asyncDep', 'asyncResolved', 'isMounted', 'isUnmounted', 'isDeactivated', 'bc', 'c', 'bm', 'm', 'bu', 'u', 'um', 'bum', 'da', 'a', 'rtg', 'rtc', 'ec', 'emit', 'emitted' \n]\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br")])]),s("p",[n._v("æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€äº›å¾ˆç†Ÿæ‚‰çš„å±æ€§ï¼šæ¯”å¦‚ "),s("code",[n._v("slots")]),n._v("ã€"),s("code",[n._v("data")]),n._v("ï¼Œ"),s("code",[n._v("suspense")]),n._v(" æ˜¯ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œ"),s("code",[n._v("emit")]),n._v(" æ— éœ€å¤šè¨€ã€‚è¿˜æœ‰æ¯”å¦‚ "),s("code",[n._v("attrs")]),n._v("ã€"),s("code",[n._v("bc")]),n._v("ã€ "),s("code",[n._v("c")]),n._v("ã€"),s("code",[n._v("bm")]),n._v(" è¿™äº›æ˜¯ç”Ÿå‘½å‘¨æœŸé’©å­ï¼š"),s("code",[n._v("bc")]),n._v(" æ˜¯ "),s("code",[n._v("beforeCreate")]),n._v(", "),s("code",[n._v("c")]),n._v(" æ˜¯ "),s("code",[n._v("created")]),n._v("ã€‚ä¹Ÿæœ‰ä¸€äº›å†…éƒ¨å”¯ä¸€çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œå¦‚ "),s("code",[n._v("rtg")]),n._v("ï¼Œä¹Ÿå°±æ˜¯ "),s("code",[n._v("renderTriggered")]),n._v(", å½“ "),s("code",[n._v("props")]),n._v(" æˆ– "),s("code",[n._v("data")]),n._v(" å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç”¨äºæ›´æ–°æ“ä½œï¼Œä»è€Œå†æ¸²æŸ“ã€‚")]),n._v(" "),s("blockquote",[s("p",[n._v("æœ¬ç¯‡æˆ‘ä»¬éœ€è¦ç‰¹åˆ«å…³æ³¨çš„æ˜¯ï¼š"),s("code",[n._v("vnode")]),n._v("ã€"),s("code",[n._v("subTree")]),n._v("ã€"),s("code",[n._v("component")]),n._v("ã€"),s("code",[n._v("type")]),n._v(" å’Œ "),s("code",[n._v("children")]),n._v("ã€‚")])]),n._v(" "),s("h2",{attrs:{id:"åŒ¹é…-findcomponent"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åŒ¹é…-findcomponent"}},[n._v("#")]),n._v(" åŒ¹é… findComponent")]),n._v(" "),s("p",[n._v("æ¥å…ˆçœ‹ "),s("code",[n._v("vnode")]),n._v("ï¼Œå®ƒæœ‰å¾ˆå¤šå±æ€§ï¼Œæˆ‘ä»¬éœ€è¦å…³æ³¨çš„æ˜¯ "),s("code",[n._v("type")]),n._v(" å’Œ "),s("code",[n._v("component")]),n._v(" è¿™ä¸¤ä¸ªã€‚")]),n._v(" "),s("p",[n._v("// æ‰“å° console.log(app.$.vnode.component)")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("console.log(app.$.vnode.component) \n<ref *1> { \n  uid: 0, \n  vnode: { \n    __v_isVNode: true, \n    __v_skip: true, \n    type: { \n      name: 'C', \n      data: [Function: data], \n      render: [Function: render], \n      __props: [] \n  }, // ... many more things ... } }\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br")])]),s("p",[s("code",[n._v("type")]),n._v(" å¾ˆæœ‰æ„æ€ï¼å®ƒä¸æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„ "),s("code",[n._v("C")]),n._v(" ç»„ä»¶ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒä¹Ÿæœ‰ "),s("code",[n._v("[Function: data]")]),n._v("ï¼ˆæˆ‘ä»¬åœ¨å‰é¢å®šä¹‰äº†ä¸€ä¸ª "),s("code",[n._v("msg")]),n._v(" æ•°æ®æ˜¯æˆ‘ä»¬çš„æŸ¥æ‰¾ç›®æ ‡ï¼‰ã€‚å®é™…ä¸Šæˆ‘ä»¬å°è¯•å¯ä»¥ä½œä»¥ä¸‹æ‰“å°ï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("console.log(C === app.$.vnode.component.type) //=> true\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br")])]),s("p",[n._v("å¤©å‘ï¼äºŒè€…ç«Ÿç„¶æ˜¯ç›¸ç­‰çš„ï¼ğŸ˜®")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("console.log(C === app.$.vnode.type) //=> true\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br")])]),s("p",[n._v("è¿™æ ·ä¹Ÿæ˜¯ç›¸ç­‰çš„ï¼ğŸ˜®")]),n._v(" "),s("p",[n._v("ï¼ˆä½ æ˜¯å¦ä¼šç–‘é—®è¿™ä¸¤ä¸ªå±æ€§ä¸ºä»€ä¹ˆä¼šæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿè¿™é‡Œå…ˆæš‚ä¸”æŒ‰ä¸‹ä¸è¡¨ã€è‡ªè¡Œæ¢ç´¢ã€‚ï¼‰")]),n._v(" "),s("p",[n._v("æ— è®ºå¦‚ä½•ï¼Œæˆ‘ä»¬ç®—æ˜¯å¾—åˆ°äº†å¯»æ‰¾åˆ°ç»„ä»¶çš„é€”å¾„ã€‚")]),n._v(" "),s("p",[n._v("é€šè¿‡è¿™é‡Œçš„æ‰¾å¯»è¿‡ç¨‹ï¼Œæˆ‘ä»¬è¿˜èƒ½å†è¿›ä¸€æ­¥å¾—åˆ°ä»¥ä¸‹ç›¸ç­‰å…³ç³»ï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("console.log( \n  app.$\n  .subTree.children[0].component\n  .subTree.children[0].component.type === A) //=> true\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br")])]),s("p",[n._v("åœ¨æœ¬ä¾‹ä¸­ï¼Œ"),s("code",[n._v("div")]),n._v(" èŠ‚ç‚¹çš„ "),s("code",[n._v("subTree.children")]),n._v(" æ•°ç»„é•¿åº¦æ˜¯ 2 ã€‚æˆ‘ä»¬çŸ¥é“äº†è™šæ‹Ÿ DOM çš„é€’å½’æœºåˆ¶ï¼Œå°±å¯ä»¥æ²¿ç€è¿™ä¸ªæ–¹å‘ï¼š"),s("code",[n._v("subTree -> children -> component")]),n._v(" æ¥ç»™å‡ºæˆ‘ä»¬çš„é€’å½’è§£å†³æ–¹æ¡ˆã€‚")]),n._v(" "),s("h2",{attrs:{id:"å®ç°-findcomponent"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°-findcomponent"}},[n._v("#")]),n._v(" å®ç° findComponent")]),n._v(" "),s("p",[n._v("æˆ‘ä»¬é¦–å…ˆå®ç° "),s("code",[n._v("matches")]),n._v(" å‡½æ•°ï¼Œç”¨äºåˆ¤æ–­æ˜¯å½“å‰ vnode èŠ‚ç‚¹å’Œç›®æ ‡æ˜¯å¦ç›¸ç­‰ã€‚")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("function matches(vnode, target) { \n  return vnode?.type === target\n}\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br")])]),s("p",[n._v("ç„¶åæ˜¯ "),s("code",[n._v("findComponent")]),n._v(" å‡½æ•°ï¼Œå®ƒæ˜¯æˆ‘ä»¬è°ƒç”¨å¹¶æŸ¥æ‰¾å†…éƒ¨é€’å½’å‡½æ•°çš„å…¬å…± APIã€‚")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("function findComponent(comp, { within }) { \n  const result = find([within.$], comp) \n  if (result) { \n    return result \n  } \n}\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br")])]),s("p",[s("strong",[n._v("æ­¤å¤„çš„ "),s("code",[n._v("find")]),n._v(" æ–¹æ³•çš„å®ç°æ˜¯æˆ‘ä»¬è¦é‡ç‚¹è®¨è®ºçš„")]),n._v("ã€‚")]),n._v(" "),s("p",[n._v("æˆ‘ä»¬çŸ¥é“å†™é€’å½’ï¼Œæœ€é‡è¦çš„æ˜¯åˆ¤æ–­ä»€ä¹ˆæ—¶å€™ç»“æŸ loopï¼Œæ‰€ä»¥ find å‡½æ•°åº”è¯¥å…ˆæ˜¯è¿™æ ·çš„ï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("function find(vnodes, target) { \n  if (!Array.isArray(vnodes)) { \n    return \n  } \n}\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br")])]),s("p",[n._v("ç„¶åï¼Œåœ¨éå† vnode æ—¶ï¼Œå¦‚æœæ‰¾åˆ°åŒ¹é…çš„ç»„ä»¶ï¼Œåˆ™å°†å…¶è¿”å›ã€‚å¦‚æœæ‰¾ä¸åˆ°åŒ¹é…çš„ç»„ä»¶ï¼Œåˆ™å¯èƒ½éœ€è¦æ£€æŸ¥ vnode.subTree.children æ˜¯å¦å·²å®šä¹‰ï¼Œä»è€Œæ›´æ·±å±‚æ¬¡çš„æŸ¥è¯¢åŠåŒ¹é…ã€‚æœ€åï¼Œå¦‚æœéƒ½æ²¡æœ‰ï¼Œæˆ‘ä»¬åˆ™è¿”å›ç´¯åŠ å™¨ accã€‚æ‰€ä»¥ï¼Œä»£ç å¦‚ä¸‹ï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("function find(vnodes, target) {\n  if (!Array.isArray(vnodes)) {\n    return \n  }\n\n  return vnodes.reduce((acc, vnode) => {\n    if (matches(vnode, target)) {\n      return vnode\n    }\n\n    if (vnode?.subTree?.children) {\n      return find(vnode.subTree.children, target)\n    }\n\n    return acc\n  }, {})\n}\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br")])]),s("p",[n._v("å¦‚æœä½ åœ¨ "),s("code",[n._v("if (vnode?.subTree?.children) {")]),n._v(" è¿™é‡Œè¿›è¡Œä¸€ä¸ªæ‰“å° "),s("code",[n._v("console.log")]),n._v("ï¼Œä½ èƒ½æ‰¾åˆ° "),s("code",[n._v("B")]),n._v(" ç»„ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ "),s("code",[n._v("A")]),n._v(" ç»„ä»¶çš„è·¯å¾„å¦‚ä¸‹ï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("app.$ \n  .subTree.children[0].component \n  .subTree.children[0].component.type === A) //=> true\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br")])]),s("p",[n._v("æ‰€ä»¥æˆ‘ä»¬å†æ¬¡è°ƒç”¨äº† "),s("code",[n._v("find")]),n._v(" æ–¹æ³•ï¼š"),s("code",[n._v("find(vnode.subTree.children, target)")]),n._v("ï¼Œåœ¨ä¸‹ä¸€æ¬¡è¿­ä»£ä¸­æŸ¥æ‰¾çš„ç¬¬ä¸€ä¸ªå‚æ•°å°†æ˜¯"),s("code",[n._v("app.$.subTree.children")]),n._v("ï¼Œå®ƒæ˜¯ vnode çš„æ•°ç»„ã€‚æˆ‘ä»¬ä¸ä»…éœ€è¦æ£€æŸ¥"),s("code",[n._v("vnode.subTree.children")]),n._v("ï¼Œè¿˜éœ€è¦æ£€æŸ¥"),s("code",[n._v("vnode.component.subTree")]),n._v("ã€‚")]),n._v(" "),s("p",[n._v("æ‰€ä»¥ï¼Œæœ€å find æ–¹æ³•å¦‚ä¸‹ï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("function find(vnodes, target) {\n  if (!Array.isArray(vnodes)) {\n    return \n  }\n\n  return vnodes.reduce((acc, vnode) => {\n    if (matches(vnode, target)) {\n      return vnode\n    }\n\n    if (vnode?.subTree?.children) {\n      return find(vnode.subTree.children, target)\n    }\n\n    if (vnode?.component?.subTree) {\n      return find(vnode.component.subTree.children, target)\n    }\n\n    return acc\n  }, {})\n}\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br"),s("span",{staticClass:"line-number"},[n._v("18")]),s("br"),s("span",{staticClass:"line-number"},[n._v("19")]),s("br"),s("span",{staticClass:"line-number"},[n._v("20")]),s("br"),s("span",{staticClass:"line-number"},[n._v("21")]),s("br")])]),s("p",[n._v("ç„¶åæˆ‘ä»¬å†è°ƒç”¨å®ƒï¼š")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("const result = findComponent(A, { within: app })\n\nconsole.log( result.component.proxy.msg ) // => 'msg'\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br")])]),s("p",[n._v("æˆ‘ä»¬æˆåŠŸäº†ï¼é€šè¿‡ "),s("code",[n._v("findComponent")]),n._v("ï¼Œæ‰¾åˆ°äº† "),s("code",[n._v("msg")]),n._v("!")]),n._v(" "),s("p",[n._v("å¦‚æœä½ ä»¥å‰ä½¿ç”¨è¿‡ Vue Test Utilsï¼Œå¯èƒ½è§è¿‡ç±»ä¼¼çš„ä¸œè¥¿ "),s("code",[n._v("wrapper.vm.msg")]),n._v("ï¼Œå®ƒå®é™…ä¸Šæ˜¯åœ¨å†…éƒ¨è®¿é—® "),s("code",[n._v("proxy")]),n._v("ï¼ˆå¯¹äºVue 3ï¼‰æˆ– "),s("code",[n._v("vm")]),n._v("ï¼ˆå¯¹äºVue 2ï¼‰ã€‚")]),n._v(" "),s("h2",{attrs:{id:"å°ç»“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å°ç»“"}},[n._v("#")]),n._v(" å°ç»“")]),n._v(" "),s("p",[n._v("æœ¬ç¯‡çš„å®ç°å¹¶éå®Œç¾ï¼Œç°å®å®ç°ä¸Šè¿˜éœ€è¦æ‰§è¡Œæ›´å¤šæ£€æŸ¥ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½¿ç”¨ "),s("code",[n._v("template")]),n._v("æˆ– "),s("code",[n._v("Suspense")]),n._v("ç»„ä»¶æ—¶ï¼Œéœ€è¦ä½œæ›´å¤šåˆ¤æ–­ã€‚ä¸è¿‡è¿™äº›ä½ å¯ä»¥åœ¨ Vue Test Utils "),s("a",{attrs:{href:"https://github.com/vuejs/vue-test-utils-next/blob/master/src/utils/find.ts",target:"_blank",rel:"noopener noreferrer"}},[n._v("æºç "),s("OutboundLink")],1),n._v(" ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå¸Œæœ›èƒ½å¸®åŠ©ä½ è¿›ä¸€æ­¥ç†è§£è™šæ‹Ÿ DOMã€‚")]),n._v(" "),s("p",[n._v("æœ¬ç¯‡ "),s("a",{attrs:{href:"https://github.com/lmiller1990/vdom-traverse-article",target:"_blank",rel:"noopener noreferrer"}},[n._v("æºç åœ°å€"),s("OutboundLink")],1),n._v("ï¼Œå°æ‰‹ä¸€åŠ¨ã€ä¸€ä¸‹å°±æ‡‚~")]),n._v(" "),s("p",[n._v("å¥½å•¦ï¼Œä»¥ä¸Šå°±æ˜¯æœ¬æ¬¡åˆ†äº«~")]),n._v(" "),s("p",[n._v("å¦‚æœå–œæ¬¢ï¼Œç‚¹èµå…³æ³¨ğŸ‘ğŸ‘ğŸ‘~æˆ‘æ˜¯æ˜é‡‘å®‰ä¸œå°¼ï¼Œå…³æ³¨å…¬ä¼—å·ã€æ˜é‡‘å®‰ä¸œå°¼ã€‘ï¼ŒæŒç»­è¾“å‡ºingï¼")])])}),[],!1,null,null,null);e.default=t.exports}}]);