(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{568:function(e,t,r){"use strict";r.r(t);var _=r(2),v=Object(_.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("p",[e._v("本篇译自："),r("a",{attrs:{href:"https://levelup.gitconnected.com/basics-of-ci-cd-a98340c60b04",target:"_blank",rel:"noopener noreferrer"}},[e._v("levelup.gitconnected.com/basics-of-ci-cd"),r("OutboundLink")],1)]),e._v(" "),r("p",[e._v("CI 全名是 "),r("em",[e._v("Continuous Integration")]),e._v(" —— 持续集成；")]),e._v(" "),r("p",[e._v("CD 全名是 "),r("em",[e._v("Continuous Delivery")]),e._v(" —— 持续交付；")]),e._v(" "),r("p",[e._v("任何商业软件项目都希望通过业务流程的自动化来迅速盈利。迭代快、发布快、更新稳定，就意味着项目能走得更远；")]),e._v(" "),r("p",[e._v("虽然，这个过程可以手动，但是手动克隆代码库、手动链接远程服务器、手动构建、手动运行命令等，任何一个手动的过程都意味着比自动要承受更大的出错风险！")]),e._v(" "),r("h2",{attrs:{id:"ci"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#ci"}},[e._v("#")]),e._v(" CI")]),e._v(" "),r("p",[r("strong",[e._v("CI 持续集成")]),e._v(" 描述了存储库变更过程，如图：")]),e._v(" "),r("p",[r("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9e14dea8736645bda942f2be40d7bd3f~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),e._v(" "),r("p",[e._v("我们可以协同工作，最后的更改都会应用到 master 分支上；但这样一个简单的模型也隐藏着一些问题：")]),e._v(" "),r("p",[e._v("一、 如何知道 master 分支的代码部署成功了？")]),e._v(" "),r("p",[e._v("二、 如何验证单元测试的覆盖率？")]),e._v(" "),r("p",[e._v("三、 如何判断团队成员是否按统一的代码规范来编码？")]),e._v(" "),r("p",[e._v("这些问题也可以手动验证，但就是麻烦、低效、易出错；不如交给自动化的 CI ，它就是来干这个的！")]),e._v(" "),r("p",[e._v("第一点：如何知道 master 分支的代码部署成功了？")]),e._v(" "),r("p",[r("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/78d493667061494b95697453d7ac17c1~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),e._v(" "),r("p",[e._v("CI 过程如下：")]),e._v(" "),r("ol",[r("li",[e._v("每次推送更改时，Git 服务器都会向 CI 服务器发送一个通知；")]),e._v(" "),r("li",[e._v("CI 服务器克隆存储库，检出分支，并与主分支合并；")]),e._v(" "),r("li",[e._v("然后启动构建脚本；")]),e._v(" "),r("li",[e._v("如果返回 Code 为 0，则表示构建成功。否则，被视为失败；")]),e._v(" "),r("li",[e._v("CI 服务器将带有构建结果的请求发送到 Git 服务器；")]),e._v(" "),r("li",[e._v("如果构建成功，则允许合并请求。否则，合并被阻止；")])]),e._v(" "),r("p",[e._v("这个过程保证合并到主分支的代码不会破坏构建！")]),e._v(" "),r("p",[e._v("第二点：测试覆盖率检测！")]),e._v(" "),r("p",[e._v("在任何时候，master 分支的测试覆盖率都不应低于 50%；我们可以借助 "),r("a",{attrs:{href:"https://www.eclemma.org/jacoco/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Jacoco plugin"),r("OutboundLink")],1),e._v(" 插件来实现这一检测；")]),e._v(" "),r("p",[e._v("但是，如何使用这个插件，也需要去探究：并不是所有代码都该去遍历~")]),e._v(" "),r("p",[r("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0e3ce1e1efed498da2d95ae298fe6074~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),e._v(" "),r("p",[e._v("借助 "),r("a",{attrs:{href:"https://sonarcloud.io/",target:"_blank",rel:"noopener noreferrer"}},[r("em",[e._v("SonarCloud")]),r("OutboundLink")],1),e._v(" ，可以实现只检查新增代码的测试覆盖率！")]),e._v(" "),r("p",[e._v("第三点：统一代码风格；")]),e._v(" "),r("p",[e._v("可以借助 "),r("a",{attrs:{href:"https://checkstyle.sourceforge.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Checkstyle"),r("OutboundLink")],1),e._v(" 插件！比如代码中有一个未使用的 import ，则直接返回构建失败；当然，这个可以根据项目需求来个性配置；")]),e._v(" "),r("h2",{attrs:{id:"cd"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#cd"}},[e._v("#")]),e._v(" CD")]),e._v(" "),r("p",[r("strong",[e._v("CD 持续交付")]),e._v(" 描述了项目新版本自动部署的过程~")]),e._v(" "),r("p",[e._v("一图胜千言：")]),e._v(" "),r("p",[r("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fb52aff8985d410baaa5c92b9e1f9563~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),e._v(" "),r("p",[e._v("之前的 CI 服务器演变成了现在的 CI/CD 服务器，你可以将 CI 作业委派给 "),r("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/",target:"_blank",rel:"noopener noreferrer"}},[r("em",[e._v("GitLab CI")]),r("OutboundLink")],1),e._v("，将 CD 作业委派给 "),r("a",{attrs:{href:"https://www.jenkins.io/",target:"_blank",rel:"noopener noreferrer"}},[r("em",[e._v("Jenkins")]),r("OutboundLink")],1),e._v("。")]),e._v(" "),r("p",[e._v("CI 部分前面已经说过，下面讲下 CD 细节；")]),e._v(" "),r("p",[e._v("实际上，我们可以在多个阶段进行部署操作：")]),e._v(" "),r("ol",[r("li",[e._v("请求合并时部署；")]),e._v(" "),r("li",[e._v("定时器部署；")]),e._v(" "),r("li",[e._v("Pull Request 合到特定分支时进行部署；")]),e._v(" "),r("li",[e._v("还可组合以上选项；")])]),e._v(" "),r("p",[e._v("了解部署过程、选择合适的部署方式很重要，部署就是版本的发布！")]),e._v(" "),r("p",[e._v("这里提供一些常用的 CI/CD 工具："),r("a",{attrs:{href:"https://www.jenkins.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Jenkins"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://github.com/features/actions",target:"_blank",rel:"noopener noreferrer"}},[e._v("GitHub Actions"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/",target:"_blank",rel:"noopener noreferrer"}},[e._v("GitLab CI"),r("OutboundLink")],1),e._v("、"),r("a",{attrs:{href:"https://www.travis-ci.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Travis CI"),r("OutboundLink")],1)]),e._v(" "),r("hr"),e._v(" "),r("p",[e._v("OK，以上就是本篇分享啦~")]),e._v(" "),r("p",[e._v("撰文不易，点赞鼓励👍👍👍👍👍👍")]),e._v(" "),r("blockquote",[r("p",[e._v("我是掘金安东尼，公众号同名，日拱一卒、日掘一金，再会~")])])])}),[],!1,null,null,null);t.default=v.exports}}]);