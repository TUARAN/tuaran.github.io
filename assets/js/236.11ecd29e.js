(window.webpackJsonp=window.webpackJsonp||[]).push([[236],{730:function(s,a,n){"use strict";n.r(a);var e=n(2),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("携手创作，共同成长！这是我参与「掘金日新计划 · 8 月更文挑战」的第13天，"),n("a",{attrs:{href:"https://juejin.cn/post/7123120819437322247",title:"https://juejin.cn/post/7123120819437322247",target:"_blank",rel:"noopener noreferrer"}},[s._v("点击查看活动详情"),n("OutboundLink")],1)]),s._v(" "),n("hr"),s._v(" "),n("p",[s._v("新系列《这些前端新技术你很难再忽视了》，包括：SolidJS、Svelte、Tauri、Bun、Schema等。每一个都引领前端技术演变趋势，很有必要了解。")]),s._v(" "),n("p",[s._v("咱们将采用 5W1H 分析法，即 What（何事）、Why（何因）、Where（何地）、When（何时）、何人（Who）、How（何法）6 个维度来解析这些“新玩意儿”。")]),s._v(" "),n("p",[s._v("本篇带来 —— pnpm")]),s._v(" "),n("p",[s._v("闲话少说，冲了~")]),s._v(" "),n("ul",[n("li",[s._v("点赞收藏关注，今晚一夜暴富 👍👍👍")])]),s._v(" "),n("h2",{attrs:{id:"🤔what"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#🤔what"}},[s._v("#")]),s._v(" 🤔What")]),s._v(" "),n("blockquote",[n("p",[s._v("什么是 pnpm？")])]),s._v(" "),n("blockquote",[n("p",[s._v("答：简单理解 pnpm 就是 npm、yarn 的同类竞争对手，是一款现代包管理器。")])]),s._v(" "),n("h2",{attrs:{id:"🧐why"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#🧐why"}},[s._v("#")]),s._v(" 🧐Why")]),s._v(" "),n("blockquote",[n("p",[s._v("那为什么要选 pnpm ，而不是 npm 或 yarn 呢？给出理由")])]),s._v(" "),n("blockquote",[n("p",[s._v("答：我不但能给出理由，还能给出 3 大点！")])]),s._v(" "),n("ol",[n("li",[n("h2",{attrs:{id:"节省磁盘空间"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#节省磁盘空间"}},[s._v("#")]),s._v(" 节省磁盘空间")])])]),s._v(" "),n("p",[s._v("当使用 npm 或 Yarn 时，如果你有 100 个项目，并且所有项目都有一个相同的依赖包，那么， 你在硬盘上就需要保存 100 份该相同依赖包的副本。然而，如果是使用 pnpm，依赖包将被 存放在一个统一的位置。")]),s._v(" "),n("p",[s._v("如果你对同一依赖包需要使用不同的版本，则仅有 版本之间不同的文件会被存储起来。例如，如果某个依赖包包含 100 个文件，其发布了一个新 版本，并且新版本中只有一个文件有修改，"),n("strong",[s._v("则 pnpm update 只需要添加一个 新文件到存储中")]),s._v("，而不会因为一个文件的修改而保存依赖包的 所有文件。")]),s._v(" "),n("p",[s._v("所有文件都保存在硬盘上的统一的位置。当安装软件包时，"),n("strong",[s._v("其包含的所有文件都会硬链接自此位置，而不会占用 额外的硬盘空间。")]),s._v(" 这让你可以在项目之间方便地共享相同版本的依赖包。")]),s._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[n("h2",{attrs:{id:"安装包速度快"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装包速度快"}},[s._v("#")]),s._v(" 安装包速度快")])])]),s._v(" "),n("p",[s._v("安装包速度有多快呢？看官网 https://github.com/pnpm/benchmarks-of-javascript-package-managers 生图直出：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2aeb4ce0423e4596ab83c2173a9f45d7~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),s._v(" "),n("p",[s._v("可以看到，在多数场景下，pnpm 包安装的速度都是明显优于 npm/yarn，速度会快 2-3 倍。")]),s._v(" "),n("ol",{attrs:{start:"3"}},[n("li",[n("h2",{attrs:{id:"非扁平-node-module-结构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#非扁平-node-module-结构"}},[s._v("#")]),s._v(" 非扁平 node_module 结构")])])]),s._v(" "),n("p",[s._v("当使用 npm 安装依赖包时，所有软件包都将被提升到 node_modules 的 根目录下。")]),s._v(" "),n("p",[n("strong",[s._v("这样会有几个问题：幽灵依赖、不确定性、依赖分身，我们逐个解析~")])]),s._v(" "),n("ul",[n("li",[s._v("幽灵依赖")])]),s._v(" "),n("p",[s._v("幽灵依赖的定义是：子依赖提升造成的，虽然不会出现在package.json中（声明缺失），但是仍可以在项目中正常被 import，即可以访问非法（未声明的） npm 包。")]),s._v(" "),n("p",[s._v("比如 A@1.0.0 依赖 B@1.0.0")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("node_modules\n├── A@1.0.0\n├── B@1.0.0\n└── C@1.0.0\n  └── node_modules\n    └── B@2.0.0\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("在package.json中，没有 B 依赖的声明，因为它是子依赖，被扁平化 "),n("strong",[s._v("提升")]),s._v(" 到了和 A 一个层级而已。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "dependencies": {\n    "A": "^1.0.0",\n    "C": "^1.0.0"\n  }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("虽然没有在package.json中声明，但在项目中引用 B 还是能正常工作的，如果某天某个版本的 A 依赖不再依赖 B 或者 B 的版本发生了变化，那么就会造成依赖缺失或兼容性问题。")]),s._v(" "),n("ul",[n("li",[s._v("不确定性")])]),s._v(" "),n("p",[s._v("不确定性是指：同样的 package.json 文件，install 依赖后可能不会得到同样的 node_modules 目录结构")]),s._v(" "),n("p",[s._v("沿用上面的例子，A 依赖 B@1.0，C 依赖 B@2.0，在 package.json 安装 B 依赖，究竟应该提升 B 的 1.0 还是 2.0？就有两种情况了：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("node_modules\n├── A@1.0.0\n├── B@1.0.0\n└── C@1.0.0\n  └── node_modules\n    └── B@2.0.0\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("node_modules\n├── A@1.0.0\n│ └── node_modules\n│   └── B@1.0.0\n├── B@2.0.0\n└── C@1.0.0\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("这样就取决于用户的安装顺序了，或者要删掉重装，否则导致扁平化处理中提升不一致，导致“不确定性”。")]),s._v(" "),n("ul",[n("li",[s._v("依赖分身")])]),s._v(" "),n("p",[s._v("依赖分身指的是：相同版本的依赖被重复安装")]),s._v(" "),n("p",[s._v("在上例基础上，我们假设再新增两个依赖关系：A 和 D 都依赖 B@1.0.0、C 和 E 都依赖 B@2.0.0")]),s._v(" "),n("p",[s._v("关系演变成：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("node_modules\n├── A@1.0.0\n├── B@1.0.0\n├── D@1.0.0\n├── C@1.0.0\n│ └── node_modules\n│   └── B@2.0.0\n└── E@1.0.0\n  └── node_modules\n    └── B@2.0.0\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("可以看到 B@2.0 会被安装两次，实际上无论提升 B@1.0.0 还是 B@2.0.0，都会被重复安装。")]),s._v(" "),n("p",[s._v("pnpm 则是通过使用符号链接的方式仅将项目的直接依赖项添加到 node_modules 的根目录下。既保证了安全性，又解决了非法访问依赖、不确定性、重复安装的问题。")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/54edeba329e64b71a7d0252216b28a8a~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),s._v(" "),n("h2",{attrs:{id:"🤫where"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#🤫where"}},[s._v("#")]),s._v(" 🤫Where")]),s._v(" "),n("blockquote",[n("p",[s._v("官方文档地址？还是看文档更准确。")])]),s._v(" "),n("blockquote",[n("p",[s._v("答：https://www.pnpm.cn/")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/50ef2c41fc9745818add3af44ae5e28e~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),s._v(" "),n("h2",{attrs:{id:"🙄pnpm"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#🙄pnpm"}},[s._v("#")]),s._v(" 🙄pnpm")]),s._v(" "),n("blockquote",[n("p",[s._v("pnpm 什么时候诞生的？")])]),s._v(" "),n("blockquote",[n("p",[s._v("答：pnpm 于 2017 年 6 月发布。")])]),s._v(" "),n("p",[s._v("目前 npm 上周下载量已经有 10w +、github star 18k+")]),s._v(" "),n("p",[s._v("同时要提到的是：npm 是 2010 年 1 月 诞生，yarn 则在 2016 年 6 月诞生。")]),s._v(" "),n("h2",{attrs:{id:"😄who"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#😄who"}},[s._v("#")]),s._v(" 😄Who")]),s._v(" "),n("blockquote",[n("p",[s._v("pnpm 作者是谁？")])]),s._v(" "),n("blockquote",[n("p",[s._v("答：Zoltan Kochan")])]),s._v(" "),n("p",[s._v("首先他看到了 yarn 对 npm 在一致性、安全性、离线安装和性能方面的问题的解决，然后再在这个基础上，采用硬链接和软链接的方式，提高了安装速度、节约了磁盘空间、避免了“依赖分身”和“幻影依赖”的问题。")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b17b28ad8626457ea09b275d85a806b6~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),s._v(" "),n("h2",{attrs:{id:"😁how"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#😁how"}},[s._v("#")]),s._v(" 😁How")]),s._v(" "),n("blockquote",[n("p",[s._v("怎么使用？")])]),s._v(" "),n("blockquote",[n("p",[s._v("答：跟 npm install 类似，安装项目下所有的依赖。")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("// 安装 axios\npnpm install axios\n// 安装 axios 并将 axios 添加至 devDependencies\npnpm install axios -D\n// 安装 axios 并将 axios 添加至 dependencies\npnpm install axios -S\n// 移除 axios\npnpm uninstall axios --filter package-a\n// 将本地项目连接到另一个项目\npnpm link ../../axios\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("hr"),s._v(" "),n("p",[s._v("小结：本篇仅为初探，期待后续有更多探索，以及 pnpm 有更好的发展~")]),s._v(" "),n("blockquote",[n("p",[s._v("OK，以上便是本篇分享。点赞关注评论，为好文助力👍")]),s._v(" "),n("p",[s._v("我是掘金安东尼 🤠 100 万人气前端技术博主 💥 INFP 写作人格坚持 1000 日更文 ✍ 关注我，安东尼陪你一起度过漫长编程岁月 🌏")])])])}),[],!1,null,null,null);a.default=t.exports}}]);