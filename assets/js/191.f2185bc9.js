(window.webpackJsonp=window.webpackJsonp||[]).push([[191],{696:function(s,n,a){"use strict";a.r(n);var e=a(2),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("RxJS 的操作符理解起来确实比较复杂，比如最常用的几种 map 操作符，本篇就来使劲冲一冲它们！！")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6129a11968914a7c9fa3a2762dac11e9~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),s._v(" "),a("ul",[a("li",[s._v("原创文章，非商业转载请说名出处")])]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("map 操作想必大家一定不陌生：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const { of } = Rx;\nconst { map  } = RxOperators;\n\nconst namesObservable = of('A', 'B');\nnamesObservable.pipe(\n   map(name => `map ${name}`)\n)\n\nnamesObservable .subscribe(result => console.log(`${result}`))\n\n// map A\n// map B\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("很直观，因为 map 映射的是“值”，所以足够简单~")]),s._v(" "),a("p",[s._v("但是，如果说，map 映射的是 "),a("strong",[s._v("observable")]),s._v(" 呢 ？")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const { of } = Rx;\nconst { map } = RxOperators;\n\nconst namesObservable = of('A', 'B');\n\nconst http =(name)=>{\n\t  return of(`${name} 1`,`${name} 2`);\n}\n\nnamesObservable.pipe(\n   map(name => http(name))\n)\n\nnamesObservable.subscribe(result => console.log(`${result}`))\n\n// 则会得到两个 observable 对象\n// ****observable{ .. }\n// observable{ .. }\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("p",[s._v("我们在 "),a("a",{attrs:{href:"https://rxviz.com/",target:"_blank",rel:"noopener noreferrer"}},[a("OutboundLink")],1),a("a",{attrs:{href:"https://rxviz.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://rxviz.com/"),a("OutboundLink")],1),s._v(" 的弹珠图中，可以清晰的看到：返回的仍是 observable")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/292d72fb5ffc4740a33209d35b851daa~tplv-k3u1fbpfcp-watermark.image?",alt:"Untitled.png"}})]),s._v(" "),a("p",[s._v("并且 observable 由最初的 1 个，变成了 2 个（圆圈就是 observable），数据仍在里面没有被订阅解析出来。")]),s._v(" "),a("p",[s._v("虽然，我们可以用"),a("strong",[s._v("粗暴")]),s._v("的方法，在订阅 "),a("code",[s._v(".subscribe")]),s._v(" 里面再次调用订阅 "),a("code",[s._v(".subscribe")]),s._v(" ，则可得值：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const { of } = Rx;\nconst { map } = RxOperators;\n\nconst namesObservable = of('A', 'B');\n\nconst http =(name)=>{\n\t  return of(`${name} 1`,`${name} 2`);\n}\n\nnamesObservable.pipe(\n   map(name => http(name))\n)\n\nnamesObservable .subscribe(resultObservable => { \n   resultObservable.subscribe(result => console.log(`${result}`) )\n})\n\n// A1\n// A2\n// B1\n// B2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[a("strong",[s._v("但是，这样包裹写法注定是不优雅的，所以，为了解决这个差异，RxJS 引入了 —— Flattening（扁平化）策略！！")])]),s._v(" "),a("p",[s._v("我们可以借助 "),a("strong",[a("strong",[s._v("flatMap")])]),s._v(" 操作符，则能得到同样的解析值的效果~")]),s._v(" "),a("p",[a("strong",[s._v("flatMap")]),s._v(" 其实也就是我们熟知的 "),a("strong",[a("strong",[s._v("mergeMap")])]),s._v(" 操作符；")]),s._v(" "),a("p",[s._v("代码如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const { of } = Rx;\nconst { mergeMap} = RxOperators;\n\nconst namesObservable = of('A', 'B');\n\nconst http =(name)=>{\n\t  return of(`${name} 1`,`${name} 2`);\n}\n\nnamesObservable.pipe(\n   mergeMap(name => http(name))\n)\n\nnamesObservable.subscribe(result => console.log(`${result}`))\n// A1\n// A2\n// B1\n// B2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("p",[a("strong",[s._v("更进一步，沿着这种偏平化策略的思路，除了 mergeMap，RxJS 又引入了 switchMap、concatMap 和 exhaustMap，它们能够提供不同方向的拉平策略。")])]),s._v(" "),a("p",[a("strong",[s._v("我们再借助 "),a("a",{attrs:{href:"https://rxviz.com/",target:"_blank",rel:"noopener noreferrer"}},[a("OutboundLink")],1),a("a",{attrs:{href:"https://rxviz.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://rxviz.com/"),a("OutboundLink")],1),s._v(" 的弹珠图，一眼便能看到它们的差异：")])]),s._v(" "),a("p",[s._v("设置一个定时器，每一秒都发出一个 observable，一共发 3 次，来看下分别得值；")]),s._v(" "),a("ul",[a("li",[a("strong",[a("strong",[s._v("mergeMap")])])])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const { of,interval} = Rx;\nconst { mergeMap,take,map } = RxOperators;\n\nconst namesObservable = of('A', 'B');\n\nconst http =(name)=>{\n\t  return interval(1000)\n      .pipe(\n        take(3),\n        map(()=>of(`${name} 1`,`${name} 2`))\n      )\n}\n\nnamesObservable.pipe(\n   mergeMap(name => http(name))\n)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c467407641e447beb5edd43d21c41648~tplv-k3u1fbpfcp-watermark.image?",alt:"Untitled 1.png"}})]),s._v(" "),a("p",[a("strong",[a("code",[s._v("mergeMap")]),s._v(" 会同时维护多个活动的内部订阅；")])]),s._v(" "),a("ul",[a("li",[a("strong",[a("strong",[s._v("switchMap")])])])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const { of,interval} = Rx;\nconst { switchMap,take,map } = RxOperators;\n\nconst namesObservable = of('A', 'B');\n\nconst http =(name)=>{\n\t  return interval(1000)\n      .pipe(\n        take(3),\n        map(()=>of(`${name} 1`,`${name} 2`))\n      )\n}\n\nnamesObservable.pipe(\n   switchMap(name => http(name))\n)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/856976de53c9474f86670da2a9635625~tplv-k3u1fbpfcp-watermark.image?",alt:"Untitled 2.png"}})]),s._v(" "),a("p",[a("strong",[a("code",[s._v("switchMap")]),s._v("，在每次发出时，会取消前一个内部 observable 的订阅，然后订阅一个新的 observable；")])]),s._v(" "),a("ul",[a("li",[a("strong",[a("strong",[s._v("concatMap")])])])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const { of,interval} = Rx;\nconst { concatMap ,take,map } = RxOperators;\n\nconst namesObservable = of('A', 'B');\n\nconst http =(name)=>{\n\t  return interval(1000)\n      .pipe(\n        take(3),\n        map(()=>of(`${name} 1`,`${name} 2`))\n      )\n}\n\nnamesObservable.pipe(\n   concatMap (name => http(name))\n)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/848853efe52244559b3dcc4740384a41~tplv-k3u1fbpfcp-watermark.image?",alt:"Untitled 3.png"}})]),s._v(" "),a("p",[a("strong",[a("code",[s._v("concatMap")]),s._v(" 会在之前前一个内部 observable 完成后，才会订阅下一个；")])]),s._v(" "),a("ul",[a("li",[a("strong",[a("strong",[s._v("exhaustMap")])])])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const { of,interval} = Rx;\nconst { exhaustMap ,take,map } = RxOperators;\n\nconst namesObservable = of('A', 'B');\n\nconst http =(name)=>{\n\t  return interval(1000)\n      .pipe(\n        take(3),\n        map(()=>of(`${name} 1`,`${name} 2`))\n      )\n}\n\nnamesObservable.pipe(\n   exhaustMap (name => http(name))\n)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/336c68e963824b98b4f7d5addc5dc911~tplv-k3u1fbpfcp-watermark.image?",alt:"Untitled 4.png"}})]),s._v(" "),a("p",[a("strong",[a("code",[s._v("exhaustMap")]),s._v(" 映射成内部 observable，忽略其他值直到该 observable 完成；")])]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("OK，以上便是本篇分享。")]),s._v(" "),a("p",[s._v("觉得不错点个赞吧👍👍👍，您的鼓励，我的动力，坚持输出质量好文~~ 欢迎评论讨论")]),s._v(" "),a("p",[s._v("我是掘金安东尼，输出暴露输入，技术洞见生活。再会吧~~ 👋👋👋")])])}),[],!1,null,null,null);n.default=t.exports}}]);