(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{597:function(s,n,a){"use strict";a.r(n);var e=a(2),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("blockquote",[a("p",[s._v("柯里化（Currying）是把接受多个参数的函数变换成接受一个单一参数（最初函数的第一个参数）的函数，并且返回接受余下的参数而且返回结果的新函数的技术。")])]),s._v(" "),a("p",[s._v("相比大家已经不算陌生！")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const add = (a,b,c) => {\n   return a+b+c\n}\nadd(1,2,3) // 6\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const addCurry = a => b => c => a+b+c\naddCurry(1)(2)(3) // 6\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("addCurry 的 "),a("code",[s._v("return")]),s._v(" 版本写法：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const addCurryReturn = (a) => { \n  return (b)=> { \n    return (c)=> { \n      return a+b+c \n    } \n  } \n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("作者认为：从 OOP 角度来看，"),a("strong",[s._v("函数作为一等公民")]),s._v("是 JavaScript 如此怪异的主要原因；")]),s._v(" "),a("p",[s._v("把函数当成一个值来进行传递，太开放！")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const add = (a,b) => a+b\nconst sub = (a,b) => a-b\nconst calc = (a, b, cb) => cb(a,b)\ncalc(3,4, add) // 7\ncalc(3,4, sub) // -1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("上例中的 "),a("code",[s._v("calc")]),s._v(" 就是高阶函数！")]),s._v(" "),a("blockquote",[a("p",[s._v("在数学和计算机科学中，高阶函数是至少满足下列一个条件的函数：")]),s._v(" "),a("ol",[a("li",[s._v("接受一个或多个函数作为输入")]),s._v(" "),a("li",[s._v("输出一个函数")])])]),s._v(" "),a("hr"),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("function getName(name) {\n  return function greet(){\n    console.log('Hello, ', name)\n  }\n}\nconst greet = getName('Karthick')\ngreet() // Hello,  Karthick\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[a("code",[s._v("getName")]),s._v(" 返回的是后续再调用的一个函数，我敲！这不就是我们之前（"),a("a",{attrs:{href:"https://juejin.cn/post/7012119635516456967",target:"_blank",rel:"noopener noreferrer"}},[s._v("《你觉得“惰性求值”在 JS 中会怎么实现？》"),a("OutboundLink")],1),s._v("）讲的 "),a("strong",[s._v("惰性求值")]),s._v(" 吗？")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('function * st1(){\n    setTimeout(()=>{\n        console.log("惰性求值")\n    },1000)\n    yield("后续再调用")\n}\n\nlet aThunk=st1()\nconsole.log(aThunk) // st1 {<suspended>}\naThunk.next() // {value: \'后续再调用\', done: false}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("新理解：在 JavaScript 中，除了 Generator 可以实现惰性求值，闭包也可以呀！Thunk 就是一个闭包！")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("好像有点扯远了，不是说柯里化吗？咋说到闭包了？")]),s._v(" "),a("p",[s._v("别急，看下面的例子：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const addCurryReturn = (a) => { \n  return (b)=> { \n    return (c)=> { \n      return a+b+c \n    } \n  } \n}\nconst add5 = addCurryReturn(5)\nconsole.log(add5) // (b)=> { return (c)=> { return a+b+c } }\n\nconst add12 = add5(7)\nconsole.log(add12) // (c)=> { return a+b+c }\n\nadd12(7) // 19\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("当我们调用 "),a("code",[s._v("add12(7)")]),s._v(" 的时候，为什么会知道 "),a("code",[s._v("x = 5")]),s._v("、"),a("code",[s._v("y = 7")]),s._v("，是因为闭包记住了先前执行中传递的值，这就是二者的关联。")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("OK，最后回到实战："),a("strong",[s._v("柯里化 && Redux")])]),s._v(" "),a("p",[s._v("下面代码从 Redux 中摘录，extraReducers 中的属性将在 thunk resolved 时被调用；")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("// Partial file\n...\nextraReducers: {\n  [signup.pending.toString()]: (state, action) => {\n    state.loading = true\n    state.error = false\n    state.fulfilled = false\n  },\n  [signup.fulfilled.toString()]: (state, action) => {\n    state.loading = false\n    state.error = false\n    state.fulfilled = true\n  },\n  [signup.rejected.toString()]: (state, action) => {\n    state.loading = false\n    state.error = true\n    state.fulfilled = false\n  },\n  [signin.pending.toString()]: (state, action) => {\n    state.loading = true\n    state.error = false\n    state.fulfilled = false\n  },\n  [signin.fulfilled.toString()]: (state, action) => {\n    state.loading = false\n    state.error = false\n    state.fulfilled = true\n  },\n  [signin.rejected.toString()]: (state, action) => {\n    state.loading = false\n    state.error = true\n    state.fulfilled = false\n  },\n}\n...\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br")])]),a("p",[s._v("从感官上看，这样的写法 —— "),a("strong",[s._v("冗余!")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("    state.loading = true\n    state.error = false\n    state.fulfilled = false\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("对于 "),a("code",[s._v("state")]),s._v(" 的设置必须抽象；")]),s._v(" "),a("p",[s._v("我们可以创建一个函数，将 "),a("code",[s._v("fulfilled")]),s._v("、"),a("code",[s._v("loading")]),s._v(" 和 "),a("code",[s._v("error")]),s._v(" 设为可配置项，默认值为 "),a("code",[s._v("false")]),s._v("；")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const setStatus = (state, action) => ({fulfilled = false,loading = false,error = false}) => {\n  state.fulfilled = fulfilled\n  state.loading = loading\n  state.error = error}\nsetStatus(state)({fulfilled:true}) \n// This will set state.fulfilled to true and remaining to false\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("然后，代码就优化成了这样：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("extraReducers: {\n  [signup.fulfilled.toString()]: (state, action) =>\n    setStatus(state)({ fulfilled: true }),\n  [signup.pending.toString()]: (state, action) =>\n    setStatus(state)({ loading: true }),\n  [signup.rejected.toString()]: (state, action) =>\n    setStatus(state)({ error: true }),\n  [signin.fulfilled.toString()]: (state, action) =>\n    setStatus(state)({ fulfilled: true }),\n  [signin.pending.toString()]: (state, action) =>\n    setStatus(state)({ loading: true }),\n  [signin.rejected.toString()]: (state, action) =>\n    setStatus(state)({ error: true }),\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("没有设置为 "),a("code",[s._v("true")]),s._v(" 的项，都默认为 "),a("code",[s._v("fasle")]),s._v("；")]),s._v(" "),a("p",[s._v("等等，还没结束！")]),s._v(" "),a("p",[a("code",[s._v("(state, action) =>setStatus(state)")]),s._v(" 这一部分仍是重复冗余的，必须接着抽象；")]),s._v(" "),a("p",[s._v("我们将 "),a("code",[s._v("setStatus")]),s._v(" 这样的写法：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const setStatus = (state) => ({fulfilled = false,loading = false,error = false}) =>  {\n  state.fulfilled = fulfilled\n  state.loading = loading\n  state.error = error}\n\n// Usage  \nsetStatus(state)({fulfilled:true})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("改造成以下写法：（柯里化思想就在此处应用！！）")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("// Change the order of functions\nconst setStatus = ({fulfilled = false,loading = false,error = false}) => (state) => {\n  state.fulfilled = fulfilled\n  state.loading = loading\n  state.error = error}\n  \n// Usage  \nsetStatus({fulfilled:true})(state)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[a("strong",[s._v("最终的改造结果")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const setStatus = ({\n    fulfilled = false,\n    loading = false,\n    error = false,\n  }) =>\n  (state, action) => {\n    state.fulfilled = fulfilled\n    state.loading = loading\n    state.error = error\n  }\n\nextraReducers: {    \n  [signup.pending.toString()]: setStatus({ loading: true }),\n  [signup.fulfilled.toString()]: setStatus({ fulfilled: true }),\n  [signup.rejected.toString()]: setStatus({ error: true }),\n\n  [signin.pending.toString()]: setStatus({ loading: true }),\n  [signin.fulfilled.toString()]: setStatus({ fulfilled: true }),\n  [signin.rejected.toString()]: setStatus({ error: true }),\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("p",[s._v("Why？")]),s._v(" "),a("p",[s._v("因为以下的两种写法是等价的！")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("// 写法 1\nonClick((state)=> updateState(state))\n\n// 写法 2\nonClick(updateState)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("改造后的代码一定能让你走的更远！！")])])}),[],!1,null,null,null);n.default=t.exports}}]);