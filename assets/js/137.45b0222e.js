(window.webpackJsonp=window.webpackJsonp||[]).push([[137],{635:function(s,n,e){"use strict";e.r(n);var t=e(2),a=Object(t.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"è®¤æ¸…éœ€æ±‚"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#è®¤æ¸…éœ€æ±‚"}},[s._v("#")]),s._v(" è®¤æ¸…éœ€æ±‚")]),s._v(" "),e("p",[s._v("å®æˆ˜ä¸­éœ€æ±‚æ˜¯è¿™æ ·çš„ï¼š")]),s._v(" "),e("p",[s._v("web å‰ç«¯ A1 ä¸åç«¯ C1 å»ºç«‹ websocketï¼Œç­‰åç«¯ C2 æ¨é€ç»™ C1 ä¸€ä¸ªæ¶ˆæ¯åï¼ŒC1 å†å°†è¿™ä¸ªæ¶ˆæ¯æ¨å›ç»™ A1ï¼Œæœ€å A1 æ‹¿åˆ°è¿™ä¸ªå›æ‰§åæ¸²æŸ“ç•Œé¢ï¼›")]),s._v(" "),e("p",[s._v("é¢å¤–è¯´æ˜ï¼šè¿™ä¸ªå›æ‰§æ˜¯ç”±å†…åµŒåœ¨ A1 iframe é‡Œçš„ web å‰ç«¯ A2 çš„ç”¨æˆ·è¾“å…¥çš„ã€‚")]),s._v(" "),e("p",[s._v("è„‘å›¾å¦‚ä¸‹ï¼š")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://s3.jpg.cm/2021/08/06/IAEvdh.md.png",alt:"IAEvdh.md.png"}})]),s._v(" "),e("h2",{attrs:{id:"å®æˆ˜ä»£ç "}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å®æˆ˜ä»£ç "}},[s._v("#")]),s._v(" å®æˆ˜ä»£ç ")]),s._v(" "),e("p",[s._v("é€šè¿‡"),e("a",{attrs:{href:"wss://echo.websocket.org"}},[s._v("wss://echo.websocket.org")]),s._v(" æ¥æ¨¡æ‹Ÿè¿æ¥åœ°å€ï¼š")]),s._v(" "),e("p",[s._v("é‡ç‚¹è¯´æ˜ï¼š")]),s._v(" "),e("ol",[e("li",[s._v("å› ä¸ºæ‹¿åˆ° å›æ‰§ callBack åå‰ç«¯å°±ä¸»åŠ¨æ–­å¼€äº†ï¼Œæ‰€ä»¥æ–­å¼€åˆ†ä¸ºï¼šæ­£å¸¸æ–­å¼€ å’Œ å¼‚å¸¸æ–­å¼€ï¼›")]),s._v(" "),e("li",[s._v("å¼‚å¸¸æ–­å¼€è¦æœ‰é‡è¿æœºåˆ¶ï¼›")]),s._v(" "),e("li",[s._v("å¿ƒè·³å‘é€æœºåˆ¶ï¼›æ¯éš” 10 s å‘é€ä¸€ä¸ª 'ping' åˆ°åç«¯ï¼›")]),s._v(" "),e("li",[s._v("send å¤±è´¥ä¹Ÿè¦é‡è¿ï¼›")])]),s._v(" "),e("ul",[e("li",[s._v("websocket.js å®æˆ˜ä»£ç ï¼ˆå‚æ•°åšäº†ç®€åŒ–ï¼Œå¯ç›´æ¥å¤åˆ¶åœ¨æ§åˆ¶å°ä¸Šè°ƒç”¨æµ‹è¯•ï¼‰")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://s3.jpg.cm/2021/08/06/IAEBq2.md.png",alt:"IAEBq2.md.png"}})]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("var limitConnect = 20 // æ–­çº¿é‡è¿æ¬¡æ•°\nvar timeConnect = 0\n\nconst service = 'wss://echo.websocket.org'\n\n// socketåˆå§‹åŒ–\nconst webSocketInit = function() {\n\n  var ws = new WebSocket(service)\n\n  let ws_close_correctly = false\n\n  ws.onopen = function() {\n    console.log('å·²è¿æ¥TCPæœåŠ¡å™¨')\n  }\n  ws.onmessage = function(msg) {\n    if (msg.data === 'callBack') { //\n      ws.close()\n      ws_close_correctly = true\n      console.log(\"æ‹¿åˆ°å›æ‰§ï¼Œæ¸²æŸ“ç•Œé¢\")\n    }\n  }\n  ws.onclose = function() {\n    console.log(ws_close_correctly ? 'ws æ­£å¸¸æ–­å¼€' : 'ws å¼‚å¸¸æ–­å¼€')\n    reconnect(service)\n  }\n\n  // é‡è¿\n  function reconnect(service) {\n    if (ws_close_correctly) return\n\n    if (limitConnect > 0) {\n      limitConnect--\n      timeConnect++\n      console.log('ç¬¬' + timeConnect + 'æ¬¡é‡è¿')\n      setTimeout(function() {\n         webSocketInit()\n      }, 2000)\n    } else {\n      console.log('TCPè¿æ¥å·²è¶…æ—¶')\n    }\n  }\n\n  //  å¿ƒè·³ * å‘é€\n\n  var timer = setInterval(function() {\n    if (!isOpen(ws)) {\n      console.log('ws å·²æ–­å¼€ï¼Œä¸ç”¨å‘ ping')\n      clearInterval(timer)\n      return false\n    }\n    if (ws.readyState === 3) {\n      console.log('å‘é€ send å¤±è´¥ï¼Œé‡è¿')\n      clearInterval(timer)\n      reconnect(service)\n    }\n\n    ws.send('ping')\n  }, 1000 * 10)\n\n  function isOpen(ws) { return ws.readyState === ws.OPEN }\n}\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br")])]),e("p",[s._v("è°ƒç”¨ï¼š")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("webSocketInit()\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"æœ‰äº›ç–‘é—®"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#æœ‰äº›ç–‘é—®"}},[s._v("#")]),s._v(" æœ‰äº›ç–‘é—®")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("å¿ƒè·³åŒ…æ˜¯ç”±å‰ç«¯å‘æ›´å¥½ï¼Œè¿˜æ˜¯åç«¯å‘æ›´å¥½ï¼Ÿæˆ–è€…è¯´ï¼šç”±å‰ç«¯å‘ï¼Œå‘äº†ä¹‹åï¼Œåç«¯å†è¿”å›ä¸€ä¸ªï¼Œç±»ä¼¼ï¼špingã€pongã€pingã€pong......ï¼ˆå¿…è¦æ€§åˆæœ‰å¤šå°‘ï¼Ÿï¼‰")])]),s._v(" "),e("li",[e("p",[e("a",{attrs:{href:"https://bbs.csdn.net/topics/370223614",target:"_blank",rel:"noopener noreferrer"}},[s._v("å¿ƒè·³åŒ…è®¾ç½®å¤šä¹…å‘ä¸€æ¬¡æ¯”è¾ƒåˆç†ï¼Ÿ"),e("OutboundLink")],1)])]),s._v(" "),e("li",[e("p",[s._v("åœ¨æœ¬ç“œè¿™ä¸ªå®æˆ˜åœºæ™¯ä¸­ï¼Œæ¶ˆæ¯è¿˜å¯èƒ½ä¸¢å¤±ï¼ï¼æ¯”å¦‚ï¼šåœ¨ A2 ä¸­ç”¨æˆ·è¾“å…¥ä¼ é€’ç»™äº† C2ï¼Œç„¶å C2 æŠŠå›æ‰§ç»™äº† C1ï¼Œå¦‚æœæ­¤æ—¶ websocket æ˜¯ä¸­æ–­çš„ï¼Œç­‰å¾…é‡è¿åï¼ŒC1 æ˜¯å¦è¿˜èƒ½æŠŠæ¶ˆæ¯å‡†ç¡®æ¨ç»™ A1ï¼ŸC1 å’Œ C2 ä¹‹é—´éœ€è¦æœ‰ä¸€ä¸ªæœºåˆ¶æ¥è®°å½•ï¼ŒA1 æ˜¯å¦å‡†ç¡®æ”¶åˆ°äº†å›æ‰§ï¼")])]),s._v(" "),e("li",[e("p",[s._v("é¡µé¢å´©æºƒä¸‹çš„ websocket æ–­å¼€å¦‚ä½•å¤„ç†ï¼Ÿ")])])]),s._v(" "),e("p",[s._v("è¿™äº›é—®é¢˜æ˜¯å¼€æ”¾æ€§çš„ï¼åœ¨é€å±‚ç†è§£çš„è¿‡ç¨‹ä¸­ï¼Œå°†ä¼šå¯¹ websocket æœ‰æ–°çš„è®¤è¯†~")]),s._v(" "),e("h2",{attrs:{id:"è¦ç‚¹æ•´ç†"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#è¦ç‚¹æ•´ç†"}},[s._v("#")]),s._v(" è¦ç‚¹æ•´ç†")]),s._v(" "),e("p",[s._v("é€šè¿‡è¿™æ¬¡å®æˆ˜ï¼Œä¹Ÿæ¢³ç†äº†äº›æ¦‚å¿µç‚¹ï¼š")]),s._v(" "),e("ol",[e("li",[s._v("WebSocket ä¸ HTTP å’Œ HTTPS ä½¿ç”¨ç›¸åŒçš„ TCP ç«¯å£ï¼›")]),s._v(" "),e("li",[s._v("RFC 6455 ä¸­è§„å®šï¼šWebSocket è¢«è®¾è®¡ä¸ºåœ¨ HTTP 80 å’Œ 443 ç«¯å£ä¸Šå·¥ä½œï¼Œå¹¶æ”¯æŒ HTTP ä»£ç†å’Œä¸­ä»‹ï¼Œä»è€Œä½¿å…¶ä¸ HTTP åè®®å…¼å®¹ï¼›")]),s._v(" "),e("li",[s._v("socket æœ¬è´¨æ˜¯å¯¹ TCP/IP åè®®æ ˆçš„å°è£…ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªé’ˆå¯¹ TCP æˆ–è€… UDP ç¼–ç¨‹çš„æ¥å£ï¼Œå¹¶ä¸æ˜¯å¦ä¸€ç§åè®®ï¼›")]),s._v(" "),e("li",[s._v("WebSocket.readyStateï¼š0 (WebSocket.CONNECTING)æ­£åœ¨é“¾æ¥ä¸­ã€1 (WebSocket.OPEN)å·²ç»é“¾æ¥å¹¶ä¸”å¯ä»¥é€šè®¯ã€2 (WebSocket.CLOSING)è¿æ¥æ­£åœ¨å…³é—­ã€3 (WebSocket.CLOSED)è¿æ¥å·²å…³é—­æˆ–è€…æ²¡æœ‰é“¾æ¥æˆåŠŸï¼›")]),s._v(" "),e("li",[s._v("websocket åŸºæœ¬å±æ€§å’Œæ–¹æ³•-"),e("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/WebSocket",target:"_blank",rel:"noopener noreferrer"}},[s._v("MDN"),e("OutboundLink")],1),s._v(";\n......")])]),s._v(" "),e("p",[s._v("ä»¥ä¸Šï¼Œä¾¿æ˜¯æœ¬æ¬¡ websocket å®æˆ˜åˆ†äº«ï¼Œå¯ä»¥æŠŠä»£ç æ‹·åœ¨æ§åˆ¶å°ä¸Šç©ä¸€ç©å„¿~")]),s._v(" "),e("p",[s._v("çœ‹åˆ°è¿™é‡Œï¼Œå–œæ¬¢å°±ç‚¹ä¸ªèµå§~ğŸ‘ğŸ‘ğŸ‘åç»­ä¼šæœ‰æ›´å¤šå…³äºå®æˆ˜çš„åˆ†äº«ï¼"),e("strong",[s._v("å®è·µæ˜¯æ£€éªŒçœŸç†çš„å”¯ä¸€æ ‡å‡†ï¼")])]),s._v(" "),e("blockquote",[e("blockquote",[e("p",[s._v("æˆ‘æ˜¯æ˜è¿›å®‰ä¸œå°¼ï¼Œè¾“å‡ºæš´éœ²è¾“å…¥ï¼ŒæŠ€æœ¯æ´è§ç”Ÿæ´»ï¼Œä¸‹æ¬¡å†ä¼š~")])])])])}),[],!1,null,null,null);n.default=a.exports}}]);