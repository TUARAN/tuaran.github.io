(window.webpackJsonp=window.webpackJsonp||[]).push([[180],{678:function(s,n,a){"use strict";a.r(n);var e=a(2),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"它大概长什么样子"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#它大概长什么样子"}},[s._v("#")]),s._v(" 它大概长什么样子")]),s._v(" "),a("p",[s._v("我们都知道 RxJS Observable 最基础的使用方法：是建立 Observable，即调用 "),a("code",[s._v(".create")]),s._v(" API")]),s._v(" "),a("p",[s._v("使用方法如下🌰：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("var observable = Rx.Observable\n\t.create(function(observer) {\n\t\tobserver.next('Hi');\n\t\tobserver.next('Jimmy');\n\t})\n\nobservable.subscribe(\n    value => {console.log(value)}\n)\n\n// Hi\n// Jimmy\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/74ad7a126c754ec69c481057272bef47~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),s._v(" "),a("p",[s._v("创建一个 observable 实例后，当它调用 "),a("code",[s._v(".subscribe")]),s._v("，会将 "),a("code",[s._v(".next(params)")]),s._v(" 的信息传到 "),a("code",[s._v("value")]),s._v(" 并执行这个 "),a("code",[s._v("function")]),s._v("；")]),s._v(" "),a("p",[s._v("next 的过程是同步的，但，也可以是异步的，比如🌰：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("var observable = Rx.Observable\n\t.create(function(observer) {\n\t\tobserver.next('Hi');\n\t\tobserver.next('Jimmy');\n\n\t\tsetTimeout(() => {\n\t\t\tobserver.next('async');\n\t\t}, 30)\n\t})\n\nconsole.log('start');\n\nobservable.subscribe(\n  value => {console.log(value)}\n);\n\nconsole.log('end');\n\n// start\n// Hi\n// Jimmy\n// end\n// async\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[s._v("其中，"),a("code",[s._v("observer")]),s._v("，除了 "),a("code",[s._v("next")]),s._v(" 方法，")]),s._v(" "),a("p",[s._v("还有：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("complete")]),s._v(" 方法")]),s._v(" "),a("li",[a("code",[s._v("error")]),s._v(" 方法：")])]),s._v(" "),a("p",[s._v("用法如下🌰：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("var observable = Rx.Observable\n\t.create(function(observer) {\n                observer.next('Hi');\n                observer.next('Jimmy');\n                observer.complete();\n                observer.next('long time no see');\n\t})\n\nobservable.subscribe(\n    value => { console.log(value); },\n    error => { console.log('Error: ', error); },\n    complete => { console.log('complete') },\n)\n\n// Hi\n// Jimmy\n// complete\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v('complete 执行后，next 就会自动失效，不会再继续打印出 "long time no see"；')]),s._v(" "),a("p",[s._v("而 error 用于捕获 try catch 中 throw 的 'msg'；")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("                ...\n                try {\n                    observer.next('Hi');\n                    observer.next('Jimmy');\n                    throw 'some exception';\n                } catch(e) {\n                    observer.error(e)\n                }\n                ...\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h2",{attrs:{id:"为什么这么写"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么这么写"}},[s._v("#")]),s._v(" 为什么这么写")]),s._v(" "),a("p",[s._v("那它为什么要长成这个样子呢？Why？")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4e042d5a8a9a4572a4858e470db6fad5~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),s._v(" "),a("p",[s._v("我就写这样，它不香？")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("function fn1(){\n    console.log('Hi')\n    console.log('Jimmy')\n    return false\n}\n\nfn1()\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("为什么要改写为类似这样：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("function f1(cb){\n    cb('Hi')\n    cb('Jimmy')\n    return false\n}\n\nfn1(value => console.log(value))\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("本瓜最终理解为，其最具重要意义的一点是："),a("strong",[s._v("为了将【数据】和【操作数据的行为】分开！！")])]),s._v(" "),a("p",[s._v("实际上，分离【常量数据】和【操作方法】（也可以叫作计算方法/计算函数）是函数式编程的重要思想 —— 所有所需所求，都是通过计算得来的，而不改变变量的值；")]),s._v(" "),a("p",[s._v("（将一个函数作为参数传入另外一个函数，也就是 FP 中常提的高阶函数；）")]),s._v(" "),a("p",[s._v("过去，如果不将数据和操作分开，它是这样的：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("function f1(){\n    console.log('Hi')\n    console.log('Jimmy')\n    return false\n}\n\nfunction f2(){\n    alert('Hi')\n    alert('Jimmy')\n    return false\n}\n\nfn1()\nfn2()\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("在函数体内，是命令式的代码风格，将 A 数据这样操作，再将 B 数据这样操作；")]),s._v(" "),a("p",[s._v("而现在，将数据和操作分开，它是这样的：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("function stream(cb){ \n    cb('Hi')\n    cb('Jimmy')\n    return false\n}\n\nstream(value => console.log(value))\nstream(value => alert(value))\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[a("code",[s._v("stream")]),s._v(" 函数体内，声明了 A 数据、B 数据...... 是一个数据流；")]),s._v(" "),a("p",[s._v("具体怎么再操作这些数据，就再看【操作方法】是什么；")]),s._v(" "),a("p",[s._v("这样做还有另外一个很大的 "),a("strong",[s._v("好处")]),s._v("，就是：")]),s._v(" "),a("p",[s._v("对于多个数据流和多个操作，它的代码结构会更清晰，耦合度更低，拓展性更高；")]),s._v(" "),a("p",[s._v("它会是这样的：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("class Stream {\n  constructor(behavior) {\n    this.behavior = behavior\n  }\n  doHandle(cb) {\n    this.behavior(cb)\n  }\n}\n\nconst handleStream1 = new Stream(cb => {\n   cb('Hi')\n   cb('Jimmy')\n})\n\nconst handleStream2 = new Stream(cb => {\n   cb('Bye')\n   cb('Lily')\n})\n\n/********  以上是数据流声明  ********/\n/********     以下是操作     ********/\n\n// 对数据流 1，做第一种操作\nhandleStream1.doHandle(\n  value => console.log(value)\n)\n\n// 对数据流 1，做第二种操作\nhandleStream1.doHandle(\n  value => alert(value)\n)\n\n// 对数据流 2，做第一种操作\nhandleStream2.doHandle(\n  value => console.log(value)\n)\n\n// 对数据流 2，做第二种操作\nhandleStream2.doHandle(\n  value => alert(value)\n)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br")])]),a("p",[s._v("特别说明：以上的操作（ "),a("code",[s._v("console")]),s._v(" 和 "),a("code",[s._v("alert")]),s._v("） 只是一种最简单的替代操作的示意，实际代码中，会复杂的多（对数据进行复杂计算等等）。")]),s._v(" "),a("p",[s._v("我敲，这 "),a("code",[s._v("Stream")]),s._v(" 不就是 "),a("code",[s._v("Observable")]),s._v(" 吗！"),a("code",[s._v("cb")]),s._v(" 不就是 "),a("code",[s._v("observer")]),s._v("！"),a("code",[s._v("doHandle")]),s._v(" 不就是 "),a("code",[s._v("subscribe")]),s._v("！！")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1f4e59bc29644e03ad57c793533d9ddf~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),s._v(" "),a("hr"),s._v(" "),a("p",[a("strong",[s._v("小结：")])]),s._v(" "),a("p",[s._v("毫无疑问，Observable 还有更多神奇的妙用，本篇理解不过管中窥豹，但想要强调的重点即是：将数据声明和数据操作分离，是函数式编程中提高代码可读性的重要特性；至于数据形成的数据管道，以及常用管道操作，后面会继续介绍（关注不迷路）~~")]),s._v(" "),a("p",[s._v("不知道各位对 Observable 有怎样的理解，欢迎评论留言讨论。")]),s._v(" "),a("blockquote",[a("p",[s._v("我是掘金安东尼，输出暴露输入，技术洞见生活，下次见~~")])])])}),[],!1,null,null,null);n.default=t.exports}}]);