(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{564:function(s,e,n){"use strict";n.r(e);var t=n(2),a=Object(t.a)({},(function(){var s=this,e=s.$createElement,n=s._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("æœ¬ç¯‡è¯‘è‡ªï¼š"),n("a",{attrs:{href:"https://javascript.plainenglish.io/how-to-make-your-js-fetch-not-look-so-ugly-f45c89f8bc3a",target:"_blank",rel:"noopener noreferrer"}},[s._v("javascript.plainenglish.io/how-to-make-your-js-fetch-not-look-so-ugly"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("ä¸Šä¸€ç¯‡ä»‹ç»äº†å•¥å«â€œå¾®å·ä¸äºâ€ï¼Œä»Šå¤©ç»§ç»­ç®€å•å¾®å·ä¸€äº›å°çŸ¥è¯†ç‚¹ï¼šæœ¬ç¯‡å¸¦æ¥ã€Šå¦‚ä½•ä¼˜åŒ– Fetch å‡½æ•°å†™æ³•ã€‹ï¼Œè½»æ¾æ‹¿ä¸‹~")]),s._v(" "),n("p",[s._v("å†²ï¼")]),s._v(" "),n("hr"),s._v(" "),n("p",[s._v("å¸¸è§„ Fetch æ˜¯è¿™æ ·å†™çš„ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("fetch('http://example.com/movies.json')\n  .then(response => response.json())\n  .then(data => console.log(data));\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("ç¬¬ä¸€ä¸ª "),n("code",[s._v(".then")]),s._v(" é‡Œé¢æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå°†è¿”å›è½¬æ¢ä¸º json æ ¼å¼ï¼›")]),s._v(" "),n("p",[s._v("è¿™æ ·å†™ï¼Œä¸é‚£ä¹ˆå¯è¯»ï¼Œä¸”ä¸å¤Ÿ DRYï¼ˆDon't repeat yourselfï¼‰~ å› ä¸ºåŒ¿åå‡½æ•°å¹¶æ²¡æœ‰å‘Šè¯‰ä½ å‡½æ•°åŠŸèƒ½ï¼Œå¹¶ä¸”æ¯æ¬¡ Fetch éƒ½è¦è½¬æ¢æ•°æ®ä¸º json çš„è¯ï¼Œä¸ºä»€ä¹ˆä¸æŠ½å‡ºä¸€ä¸ªå¯è¢«å¤ç”¨çš„å‡½æ•°ï¼Ÿ")]),s._v(" "),n("p",[s._v("äº‹å®ä¸Šï¼Œæˆ‘ä»¬æ€»æ˜¯éœ€è¦å¯¹ä»åç«¯æ‹¿å›çš„æ•°æ®è¿›è¡Œå¤„ç†çš„ï¼Œæ‰€ä»¥å°†å¤„ç†è¿‡ç¨‹è¿›è¡Œå°è£…ä¹Ÿæ˜¯æœ‰å¿…è¦çš„~")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("function getResponse(response)\n{ return response.json() }\n\n\nfetch('http://example.com/movies.json')\n  .then(getResponse)\n  .then(data => console.log(data));\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("ä»¥ï¼ŒåŒæ ·çš„é“ç†ï¼Œå°†ç¬¬äºŒä¸ª "),n("code",[s._v(".then")]),s._v(" å†…éƒ¨çš„åŒ¿åå‡½æ•°è¿›è¡Œå°è£…ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("function processJSON(json)\n{\n  for(let i = 0; i < json.length; i++)\n  {\n    console.log(json[i])\n  }\n}\n\nfetch('http://example.com/movies.json')\n  .then(getResponse)\n  .then(processJSON);\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("Wow! ç°åœ¨ fetch å‡½æ•°çœ‹èµ·æ¥æ¸…æ™°å¤šäº†ï¼fetch => å¤„ç†å“åº” => å¤„ç† JSON æ•°æ®ï¼›è¯­ä¹‰åŒ–çš„ä»£ç ï¼Œæ‰€è§å³æ‰€æ˜¯ï¼")]),s._v(" "),n("p",[s._v("PSï¼šå…¶å®ï¼Œè¿™ä¸ªæ€æƒ³å’Œå‡½æ•°å¼ç¼–ç¨‹ä¹Ÿæ˜¯ä¸€è‡´çš„ï¼Œå‡å°‘ä½¿ç”¨åŒ¿åå‡½æ•°ï¼Œå°†å¤„ç†è¿‡ç¨‹ç”¨å‡½æ•°å°è£…ï¼Œå°è£…å‡½æ•°çš„å‡½æ•°åéƒ½æ˜¯æœ‰å…·ä½“å«ä¹‰çš„ï¼Œè®©å®ƒä»¬æ¥å¤„ç†æ•°æ®æµï¼Œè¿™æ‰æ˜¯æ­£çœŸå¯è¯»çš„ä»£ç ~")]),s._v(" "),n("p",[s._v("ä¸Šè¿°ä»£ç ï¼Œå¤„ç†è¿˜èƒ½æ›´è¿›ä¸€æ­¥ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("const moviesPath = 'http://example.com/movies.json'\n\nfetch(moviesPath)\n  .then(getResponse)\n  .then(processJSON); \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("è¿™å°±æ˜¯ Fetch å‡½æ•°æ¸…çˆ½å¹²å‡€çš„æ ·å­ï¼")]),s._v(" "),n("p",[s._v("å†ä¸¾ä¸ªæ —å­ğŸŒ°")]),s._v(" "),n("ul",[n("li",[s._v("POST å†™æ³•")])]),s._v(" "),n("p",[s._v("// ä¼˜åŒ–å‰")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("fetch('https://example.com/profile', {\n  method: 'POST', // or 'PUT'\n  headers: {\n    'Content-Type': 'application/json',\n  },\n  body: JSON.stringify(data),\n})\n.then(response => response.json())\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("// ä¼˜åŒ–å")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("function writeServer(action, data={})\n{ return { method: action, headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) } }\n\n\nfetch(moviesPath, writeServer(\"POST\", newMovie))\n  .then(getResponse)\n  .then(processJSON);\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[n("strong",[s._v("è¿™å°±æ˜¯ DRYï¼è¿™å°±æ˜¯å£°æ˜å¼ä»£ç ï¼è¿™å°±æ˜¯æ›´å¯è¯»çš„ä»£ç ï¼")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3124025c174e41cbade1bd6517c034f9~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),s._v(" "),n("p",[s._v("çœ‹åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬ä¹ŸçŸ¥é“äº†ï¼Œè¿™ç§ä¼˜åŒ–æ€è·¯ï¼ˆå°è£…ã€å£°æ˜å¼ã€æ•°æ®æµï¼‰ä¸ä»…ä»…é™äº Fetch å‡½æ•°ä¸­ï¼Œå…¶å®ƒæ•°æ®å¤„ç†çš„è¿‡ç¨‹éƒ½å¯ä»¥åº”ç”¨~ ä»ç»†èŠ‚ç€æ‰‹ï¼")]),s._v(" "),n("p",[s._v("OKï¼Œä»¥ä¸Šä¾¿æ˜¯æœ¬ç¯‡åˆ†äº«ï¼›æ’°æ–‡ä¸æ˜“ï¼Œç‚¹èµé¼“åŠ±ğŸ‘ğŸ‘ğŸ‘")]),s._v(" "),n("blockquote",[n("p",[s._v("æˆ‘æ˜¯æ˜é‡‘å®‰ä¸œå°¼ï¼Œå…¬ä¼—å·åŒåï¼Œæ—¥æ‹±ä¸€å’ã€æ—¥æ˜ä¸€é‡‘ï¼Œå†ä¼š~~")])])])}),[],!1,null,null,null);e.default=a.exports}}]);