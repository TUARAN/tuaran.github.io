(window.webpackJsonp=window.webpackJsonp||[]).push([[195],{692:function(s,n,a){"use strict";a.r(n);var e=a(2),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("观察者模式常常会和发布订阅模式一起哪来比较，它们二者同样重要。")]),s._v(" "),a("p",[s._v("直观的例子：")]),s._v(" "),a("p",[s._v("Vue 的双向绑定原理用到了发布订阅模式的思想；")]),s._v(" "),a("p",[s._v("在函数式编程中，广泛应用观察者设计模式思想。")]),s._v(" "),a("p",[s._v("但是，可能在平常，写业务代码，真实用到这两样设计思想的并不多，只好在做技术总结的时候复盘一下，温故再温故啦。（也有一种可能是：或许是运用还不是很熟，在有些场景，可以用到，但会忽视掉）")]),s._v(" "),a("p",[s._v("闲话少说，奥利给，冲它！！")]),s._v(" "),a("hr"),s._v(" "),a("h3",{attrs:{id:"简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),a("p",[s._v("观察者模式和发布订阅模式的区别在于：")]),s._v(" "),a("p",[s._v("后者比前者多了一个"),a("strong",[s._v("中间商")]),s._v("。")]),s._v(" "),a("p",[s._v("观察者模式：")]),s._v(" "),a("ol",[a("li",[s._v("观察者 Observer")]),s._v(" "),a("li",[s._v("被观察者 Subject")])]),s._v(" "),a("p",[s._v("发布订阅模式：")]),s._v(" "),a("ol",[a("li",[s._v("订阅者 subscriber （类似于观察者）")]),s._v(" "),a("li",[s._v("发布者 publisher （类似于被观察者）")]),s._v(" "),a("li",[s._v("调度中心（中间商）")])]),s._v(" "),a("p",[s._v("一图胜千言：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d0df18a6ec5f48b68585c5f0dc5d2348~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),s._v(" "),a("p",[s._v("有了以上的基本认识，咱们再展开说说~~")]),s._v(" "),a("h3",{attrs:{id:"观察者模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#观察者模式"}},[s._v("#")]),s._v(" 观察者模式")]),s._v(" "),a("p",[s._v("观察者模式之前写过 "),a("a",{attrs:{href:"https://juejin.cn/post/7072898729388277797",target:"_blank",rel:"noopener noreferrer"}},[a("OutboundLink")],1),a("a",{attrs:{href:"https://juejin.cn/post/7072898729388277797",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://juejin.cn/post/7072898729388277797"),a("OutboundLink")],1),s._v("，这里再优化下注解，并再封装一个 Observer 类，由此创建多个 Observer 实例：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('class Subject{// 被观察者\n    constructor(){\n        this.observers=[]\n    }\n    add(observer){\n        this.observers.push(observer)\n    }\n    notify(newMsg){\n        this.observers.forEach(i=>i.consoleFn(newMsg))\n    }\n}\n\nclass Observer{// 观察者\n    constructor(name){\n        this.name=name\n    }\n    consoleFn(newMsg){\n        console.log(newMsg + \'======》》》\'+ this.name +\'收到了\')\n    }\n}\n\nlet sub = new Subject()\n\nlet observer1 = new Observer("观察者1")\nlet observer2 = new Observer("观察者2")\n\nsub.add(observer1) // Observer1 观察 sub\nsub.add(observer2) // Observer2　观察　sub\n\nsub.notify("我是被观察者，我发布了一个信息！") // sub 发布消息\n\n// 我是被观察者，我发布了一个信息！======》》》观察者1收到了\n// 我是被观察者，我发布了一个信息！======》》》观察者2收到了\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br")])]),a("p",[a("strong",[s._v("要点小结：")])]),s._v(" "),a("ol",[a("li",[s._v("写一个 Subject 类，有：添加观察者 add、通知观察者 notify 方法（也可补充写删除观察者 del 方法）；")]),s._v(" "),a("li",[s._v("写一个 Observer 类，打印出所接收到的信息；")]),s._v(" "),a("li",[s._v("实例化一个被观察者；")]),s._v(" "),a("li",[s._v("实例化一个或多个观察者；")]),s._v(" "),a("li",[s._v("用 add 方法进行绑定；")]),s._v(" "),a("li",[s._v("用 notify 方法进行通知；")])]),s._v(" "),a("h3",{attrs:{id:"发布订阅模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#发布订阅模式"}},[s._v("#")]),s._v(" 发布订阅模式")]),s._v(" "),a("p",[s._v("发布订阅模式，就是比观察者模式多了一个“中间商”，也叫调度中心；")]),s._v(" "),a("p",[s._v("发布者 publisher == 被观察者 Subject")]),s._v(" "),a("p",[s._v("订阅者 subscriber == 观察者 Observer")]),s._v(" "),a("p",[s._v("调度中心 Event Channel，或者说是大家熟悉的 Vue 双向绑定中的 Dep，依赖管理中心、订阅中心")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('\n// 发布者 Publisher\nclass Pub {\n    constructor() {\n        this.deps = [];\n    }\n    addDep(dep) {\n        this.deps.push(dep);\n    }\n    publish(dep) {\n        this.deps.forEach(item => item === dep && item.notify());\n    }\n}\n// 订阅者 Subscriber\nclass Sub {\n    constructor(val) {\n        this.val = val;\n    }\n\n    update(callback) {\n        callback(this.val)\n    }\n}\n\n// 调度中心\nclass Dep {\n    constructor(callback) { // 核心是这个 callback 函数；\n        this.subs = [];\n        this.callback = callback;\n    }\n    addSub(sub) {\n        this.subs.push(sub);\n    }\n    notify() {\n        this.subs.forEach(item => item.update(this.callback));\n    }\n}\n\nlet pub = new Pub() // 实例化一个发布者\n\n// 实例化一个调度中心，传入一个用于处理数据的函数；\nconst dep1 = new Dep((data) =>\n              console.log(\'我是调度中心，我先把消息处理一下，然后发给 ===》》》\', data)) \n\nlet sub1 = new Sub("订阅者1") // 实例化订阅者1\nlet sub2 = new Sub("订阅者2") // 实例化订阅者2\n\npub.addDep(dep) // 发布者绑定调度中心\n\ndep.addSub(sub1) // 调度中心添加订阅者1\ndep.addSub(sub2) // 调度中心添加订阅者2\n\npub.publish(dep) // 发布者把消息推给调度者\n\n// 我是调度中心，我先把消息处理下先 订阅者1\n// 我是调度中心，我先把消息处理下先 订阅者2\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br")])]),a("p",[a("strong",[s._v("要点小结：")])]),s._v(" "),a("ol",[a("li",[s._v("写一个 Pub 发布者类，有添加调度中心 addDep，推送消息 publish 两个方法；")]),s._v(" "),a("li",[s._v("写一个 Sub 订阅者类，有获取信息 update 方法；")]),s._v(" "),a("li",[s._v("写一个 Dep 调度中心类，有添加订阅者 addSub，通知消息 notify 两个方法；")]),s._v(" "),a("li",[s._v("实例化发布者；")]),s._v(" "),a("li",[s._v("实例化 1 个或多个调度的对象；")]),s._v(" "),a("li",[s._v("实例化 1 个或多个订阅者对象；")]),s._v(" "),a("li",[s._v("发布者绑定调度中心；")]),s._v(" "),a("li",[s._v("调度中心绑定订阅者；")]),s._v(" "),a("li",[s._v("发布者发布消息；")])]),s._v(" "),a("p",[s._v("由上面的例子可见，发布者不会把消息直接发给订阅者，而是会先发给调度中心，再由调度中心发给订阅者；")]),s._v(" "),a("blockquote",[a("p",[s._v("有小朋友就问了：不就比观察者模式多了个“中间商”，有这个必要吗？？")])]),s._v(" "),a("p",[s._v("答案是肯定的！当然有！！")]),s._v(" "),a("p",[s._v("观察者模式中，被观察者直接把消息发给观察者，这是强绑定的，作为观察者，只有我主动绑定了我要观察的对象，我才能知道它发的消息给我；")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d206ccf6bbc34b288f64e998efe24c07~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),s._v(" "),a("p",[s._v("而在发布订阅模式中，发布者和订阅者是 "),a("strong",[s._v("完全解耦")]),s._v(" 的，作为发布者，我把消息发给调度中心之后，我就不用管了，我只负责发布消息，不管谁接收；同样，订阅者，只负责接收调度中心来的消息，不用管是哪个发布者发的；")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4248addaf7b04a528e49c937fc354186~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),s._v(" "),a("p",[s._v("高内聚、低耦合，是我们的最终追求！！")]),s._v(" "),a("h3",{attrs:{id:"小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),a("p",[s._v("观察者模式和发布订阅模式，想想还是挺有意思的；")]),s._v(" "),a("p",[s._v("为什么要这么演进，我尝试用一个实际生活场景解释 —— 领导的发言稿，要打印出来，供下面的同事学习；")]),s._v(" "),a("p",[s._v("做法1：没有任何设计思想时，每个人都去找领导要这个稿子的电子版，然后去打印；")]),s._v(" "),a("p",[s._v("做法2：用观察者模式设计思想，领导主动把这个电子稿以邮件形式群发给大家，让大家自行打印；如果稿件有内容变动的话，领导再主动推送给大家一份新的；")]),s._v(" "),a("p",[s._v("做法3：用发布订阅者模式设计思想，领导发给秘书，秘书再分发给大家；因为稿件可能存在部分敏感信息，需要经过处理，分发给不同的同事，比如某类员工只能看其中一部分内容；")]),s._v(" "),a("hr"),s._v(" "),a("blockquote",[a("p",[s._v("OK，以上便是本篇分享。 觉得不错点个赞吧👍👍👍，您的鼓励，我的动力，坚持原创质量好文~~ 欢迎评论留言 我是掘金安东尼，输出暴露输入，技术洞见生活。再会吧~~ 👋👋👋")])])])}),[],!1,null,null,null);n.default=t.exports}}]);