(window.webpackJsonp=window.webpackJsonp||[]).push([[155],{655:function(s,a,t){"use strict";t.r(a);var n=t(2),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("本文为稀土掘金技术社区首发签约文章，14天内禁止转载，14天后未获授权禁止转载，侵权必究!")]),s._v(" "),t("h2",{attrs:{id:"专栏简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#专栏简介"}},[s._v("#")]),s._v(" 专栏简介")]),s._v(" "),t("blockquote",[t("p",[s._v("作为一名 5 年经验的 JavaScript 技能拥有者，笔者时常在想，它的核心是什么？后来我确信答案是：闭包和异步。而函数式编程能完美串联了这两大核心，从高阶函数到函数组合；从无副作用到延迟处理；从函数响应式到事件流，从命令式风格到代码重用。所以，本专栏将从函数式编程角度来再看 JavaScript 精要，欢迎关注！"),t("a",{attrs:{href:"https://juejin.cn/column/7140154838981017613",title:"https://juejin.cn/column/7140154838981017613",target:"_blank",rel:"noopener noreferrer"}},[s._v("传送门"),t("OutboundLink")],1)])]),s._v(" "),t("h2",{attrs:{id:"序言"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#序言"}},[s._v("#")]),s._v(" 序言")]),s._v(" "),t("p",[s._v("转眼间，来到专栏第 3 篇，前两篇分别是：")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://juejin.cn/post/7144851873411891207",target:"_blank",rel:"noopener noreferrer"}},[s._v("✨从历史讲起，JavaScript 基因里写着函数式编程"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("a",{attrs:{href:"https://juejin.cn/post/7147454421822078984",target:"_blank",rel:"noopener noreferrer"}},[s._v("✨从柯里化讲起，一网打尽 JavaScript 重要的高阶函数"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("建议按顺序“食用”。饮水知其源，由 lambda 演算演化而来的闭包思想是 JavaScript 写在基因里的东西，闭包的“孪生子”柯里化，是封装高阶函数的利器。")]),s._v(" "),t("p",[s._v("当我们频繁使用高阶函数、甚至自己不断在封装高阶函数的时候，其实就已经把“函数是一等公民”这个最核心的函数式编程思想根植在心里面了。")]),s._v(" "),t("p",[s._v("函数可以作为参数、可以作为返回值、可以赋值给变量......")]),s._v(" "),t("p",[s._v("本篇带来 JavaScript 函数式编程思想中最重要的概念之一 —— 纯函数，它定义了："),t("strong",[s._v("写出怎样的函数才是优雅的！")]),s._v(" 由纯函数概念衍生，我们将进一步探讨：")]),s._v(" "),t("ul",[t("li",[s._v("函数的输入和输出")]),s._v(" "),t("li",[s._v("函数的副作用")]),s._v(" "),t("li",[s._v("组合函数")]),s._v(" "),t("li",[s._v("无形参风格编程")]),s._v(" "),t("li",[s._v("以及最后将一窥较难理解的函子 Monad 概念")])]),s._v(" "),t("p",[s._v("话不多说，赶紧冲了~")]),s._v(" "),t("p",[s._v("点赞 + 收藏 + 关注 === 学会")]),s._v(" "),t("h2",{attrs:{id:"纯函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#纯函数"}},[s._v("#")]),s._v(" 纯函数")]),s._v(" "),t("p",[s._v("什么样的函数才算“纯”？")]),s._v(" "),t("p",[s._v("紧扣定义，满足以下两个条件的函数可以称作纯函数：")]),s._v(" "),t("ol",[t("li",[s._v("如果函数的调用参数相同，则永远返回相同的结果。它不依赖于程序执行期间函数外部任何状态或数据的变化，必须只依赖于其输入参数。")]),s._v(" "),t("li",[s._v("该函数不会产生任何可观察的副作用，例如网络请求，输入和输出设备或数据突变（mutation）")])]),s._v(" "),t("h3",{attrs:{id:"输入-输出"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#输入-输出"}},[s._v("#")]),s._v(" 输入 & 输出")]),s._v(" "),t("p",[s._v("在纯函数中，约定："),t("strong",[s._v("相同的输入总能得到相同的输出")]),s._v("。而在日常 JavaScript 编程中，我们并没有刻意保持这一点，这会导致很多“意外”。")]),s._v(" "),t("p",[s._v("🌰 比如：分不清 slice 和 splice 的区别")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("var arr = [1,2,3,4,5];\n\narr.slice(0,3); // [1,2,3]\n\narr.slice(0,3); // [1,2,3]\n\narr.slice(0,3); // [1,2,3]\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("var arr = [1,2,3,4,5];\n\narr.splice(0,3); // [1,2,3]\n\narr.splice(0,3); // [4,5]\n\narr.splice(0,3); // []\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("使用 slice 无论多少次，相同的输入参数，都会有相同的结果；而 splice 则不会，splice 会修改原数组，导致即使参数完全相同，结果竟然完全不同。")]),s._v(" "),t("p",[s._v("在数组中，类似的、会对原数组修改的方法还有不少："),t("code",[s._v("pop()、push()、shift()、unshift()、reverse()、sort()、splice()")]),s._v(" 等，阅读代码时，想要得到原数组最终的值，必须追踪到每一次修改，这会大幅降低代码的可读性。")]),s._v(" "),t("p",[s._v("🌰 比如： random 函数的不确定")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Math.random() // 0.9706010566439833\nMath.random() // 0.26820889412263416\nMath.random() // 0.6144693062318409\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[t("code",[s._v("Math.random()")]),s._v(" 每次运行，都会产生一个介于 0 和 1 之间的新随机数，你无法预测它，相同的输入、不通的输出，意外 + 1；")]),s._v(" "),t("p",[s._v("相似的还有 "),t("code",[s._v("new Date()")]),s._v(" 函数，每次相同的调用，结果不一致；")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("new Date().toLocaleTimeString() // '11:43:44'\n\nnew Date().toLocaleTimeString() // '11:44:16'\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("🌰 比如：有隐式输出的函数")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("var tax = 20;\n\nfunction calculateTax(productPrice) {\n    tax = tax/100\n    return (productPrice * tax) + productPrice;\n}\n\ncalculateTax(100) // 120\n\ncalculateTax(100) // 100.2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("上面 "),t("code",[s._v("calculateTax")]),s._v(" 函数是一个比较隐蔽的非纯函数，输入相同的参数，得到不同的结果。")]),s._v(" "),t("p",[s._v("究其原因是因为函数输出依赖外部变量 tax，并在无意中修改了外部变量。")]),s._v(" "),t("p",[s._v("所以，综上，纯函数必须要是：有相同的输入就必须有相同输出的这样的函数，运行一次是这样，运行一万次也应该是这样。")]),s._v(" "),t("h3",{attrs:{id:"副作用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#副作用"}},[s._v("#")]),s._v(" 副作用")]),s._v(" "),t("p",[s._v("除了保障相同的输入得到相同的输出这一点外，纯函数还要求："),t("strong",[s._v("不会产生任何可观察的副作用")]),s._v("。")]),s._v(" "),t("p",[s._v("副作用指当调用函数时，除了返回可能的函数值之外，还对主调用函数产生附加的影响。")]),s._v(" "),t("p",[s._v("副作用主要包含：")]),s._v(" "),t("ul",[t("li",[s._v("可变数据")]),s._v(" "),t("li",[s._v("打印/log")]),s._v(" "),t("li",[s._v("获取用户输入")]),s._v(" "),t("li",[s._v("DOM 查询")]),s._v(" "),t("li",[s._v("发送一个 http 请求")]),s._v(" "),t("li",[s._v("Math.random()")]),s._v(" "),t("li",[s._v("获取的当前时间")]),s._v(" "),t("li",[s._v("访问系统状态")]),s._v(" "),t("li",[s._v("更改文件系统")]),s._v(" "),t("li",[s._v("往数据库插入记录")])]),s._v(" "),t("p",[s._v("🌰 举一些常见的有副作用的函数例子：")]),s._v(" "),t("p",[s._v("// 修改函数外部数据")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("let num = 0\nfunction sum(x,y){\n    num = x + y\n    return num\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("// 调用 I/O")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("function sum(x,y){\n    console.log(x,y)\n    return x+y\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("// 引用函数外检索值")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("function of(){\n    return this._value\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("// 调用磁盘方法")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("function getRadom(){\n    return Math.random()\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("// 抛出异常")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("function sum(x,y){\n    throw new Error()\n    return x + y\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("我们不喜欢副作用，它充满了不确定性，我们的函数不是一个稳定的黑盒，假设 "),t("code",[s._v("function handleA()")]),s._v(" 函数，我们只期望它的功能是 A 操作，不希望它意外的又操作了 B 或 C。")]),s._v(" "),t("p",[s._v("所以，我们在纯函数内几乎不去引用、修改函数外部的任何变量，仅仅通过最初的形参输入，经过一系列计算后再 "),t("code",[s._v("return")]),s._v(" 返回给外部。")]),s._v(" "),t("p",[s._v("但副作用真的太常见了，有时候难以避免使用带副作用的非纯函数。在 JavaScript 函数式编程中，我们并不是倡导严格控制函数不带一点副作用，而是要尽量把这个“危险的玩意”控制在可控的范围内。后面会讲到如何控制非纯函数的副作用。")]),s._v(" "),t("h2",{attrs:{id:"纯-的好处"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#纯-的好处"}},[s._v("#")]),s._v(" “纯”的好处")]),s._v(" "),t("p",[s._v("说了这么多关于“纯函数”概念，肯定有人会问：写纯函数有什么好处？我为什么要写纯函数？")]),s._v(" "),t("h3",{attrs:{id:"自文档化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自文档化"}},[s._v("#")]),s._v(" 自文档化")]),s._v(" "),t("p",[s._v("函数越纯，它的功能越明确，不需要你阅读它的时候还翻前找后，代码本身就是文档，甚至读一下方法名就能放心的使用它，而不用担心它还会不会有其它的影响。这就是代码的自文档化。")]),s._v(" "),t("p",[s._v("🌰举个例子：")]),s._v(" "),t("p",[s._v("实现一个登录功能：")]),s._v(" "),t("p",[s._v("// 非纯函数")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("signUp")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("attrs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" user "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("saveUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("attrs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("welcomeUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("saveUser")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("attrs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" user "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Db"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("save")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("attrs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("welcomeUser")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Email")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[s._v("// 纯函数")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("signUp")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("Db"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Email"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" attrs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" user "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("saveUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Db"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" attrs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("welcomeUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Email"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("saveUser")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("Db"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" attrs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("welcomeUser")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("Email"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" user")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[s._v("在纯函数表达中，每个函数需要用到的参数更明确、调用关系更明确，为我们提供了更多的基础信息，代码信息自成文档。")]),s._v(" "),t("h3",{attrs:{id:"组合函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#组合函数"}},[s._v("#")]),s._v(" 组合函数")]),s._v(" "),t("p",[s._v("本瓜常提的“组合函数”就是纯函数衍生出来的一种函数。把一个纯函数的结果作为另一个纯函数的输入，最终得到一个新的函数，就是组合函数。")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("componse")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("fns")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" fns"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("reduceRight")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("pFn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" cFn")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("args")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cFn")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("pFn")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hello")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token template-string"}},[t("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("HELLO ")]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("connect")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("firstName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" lastName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" firstName "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" lastName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toUpperCase")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toUpperCase")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("const sayHello = componse(hello, toUpperCase, connect)\n\nconsole.log(sayHello('juejin', 'anthony')) // HELLO JUEJINANTHONY\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("多个纯函数组合起来的函数也一定是纯函数。")]),s._v(" "),t("h3",{attrs:{id:"引用透明性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#引用透明性"}},[s._v("#")]),s._v(" 引用透明性")]),s._v(" "),t("p",[s._v("引用透明性是指一个函数调用可以被它的输出值所代替，并且整个程序的行为不会改变。")]),s._v(" "),t("p",[s._v("我们可以利用这个特性对纯函数进行“加和乘”的运算，这是重构代码的绝妙手段之一~")]),s._v(" "),t("p",[s._v("🌰比如：")]),s._v(" "),t("p",[s._v("优化以下代码：")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" Immutable "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'immutable'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("decrementHP")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("player")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" player"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hp"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" player"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("isSameTeam")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("player1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" player2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" player1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("team "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" player2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("team"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("punch")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("player"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" target")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isSameTeam")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("player"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" target"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" target"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("decrementHP")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("target"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" jobe "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Immutable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Map")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Jobe"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" hp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" team"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"red"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" michael "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Immutable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Map")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Michael"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" hp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" team"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"green"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("punch")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jobe"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" michael"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("p",[s._v("因为 "),t("code",[s._v("decrementHP")]),s._v(" 和 "),t("code",[s._v("isSameTeam")]),s._v(" 都是纯函数，我们可以用等式推导、手动执行、值的替换来简化代码：")]),s._v(" "),t("p",[s._v("因为数据不可变，所以 "),t("code",[s._v("isSameTeam(player, target)")]),s._v(" 替换成 "),t("code",[s._v('"red" === "green"')]),s._v("，在 puch 函数内，"),t("code",[s._v("if(false){...}")]),s._v(" 则直接删掉，然后将 "),t("code",[s._v("decrementHP")]),s._v(" 函数内联，最终简化为：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('var punch = function(player, target) {\n  return target.set("hp", target.hp-1);\n};\n\nvar jobe = Immutable.Map({name:"Jobe", hp:20, team: "red"});\nvar michael = Immutable.Map({name:"Michael", hp:20, team: "green"});\n\npunch(jobe, michael);\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("纯函数的引用透明性让纯函数能做简单运算及替换，在重构中能大大减少代码量。")]),s._v(" "),t("h3",{attrs:{id:"其它"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#其它"}},[s._v("#")]),s._v(" 其它")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("纯函数不需要访问共享的内存，这也是它的决定性好处之一。这样一来，它无需处于竞争态，使得 JS 在服务端的并行能力极大提高。")])]),s._v(" "),t("li",[t("p",[s._v("纯函数还能让测试更加容易。我们不需要模拟一个真实的场景，只需要简单模拟函数的输入、然后断言输出即可。")])]),s._v(" "),t("li",[t("p",[s._v("纯函数与运行环境无关，只要愿意吗，可以在任何地方移植它、运行它，其本身已经撇除了函数所携带的的各种隐式环境，这是命令式编程的弊病之一。")])])]),s._v(" "),t("p",[s._v("言而总之，函数尽量写“纯”一点，好处真的有很多~ 写着写着就知道了")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aefaebed52a249aebf4faa91dea2af90~tplv-k3u1fbpfcp-watermark.image?",alt:"20220602144939_45223.gif"}})]),s._v(" "),t("h2",{attrs:{id:"无形参风格"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#无形参风格"}},[s._v("#")]),s._v(" 无形参风格")]),s._v(" "),t("p",[s._v("纯函数的引用透明性可以等式推导演算，在函数式编程中，有一种流行的代码风格和它很相似，如出一辙。")]),s._v(" "),t("p",[s._v("这种风格就是无形参风格，其目的是通过移除不必要的形参-实参映射来减少视觉上的干扰。")]),s._v(" "),t("p",[s._v("🌰举例说明：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("function double(x) {\n    return x * 2;\n}\n\n[1,2,3,4,5].map( function mapper(v){\n    return double( v );\n} );\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[t("code",[s._v("double")]),s._v(" 函数和 "),t("code",[s._v("mapper")]),s._v(" 函数有着相同的形参，"),t("code",[s._v("mapper")]),s._v(" 的参数 v 可以直接映射到 "),t("code",[s._v("double")]),s._v(" 函数里的实参里，所以 "),t("code",[s._v("mapper(..)")]),s._v(" 函数包装是非必需的。我们可以将其简化为无形参风格：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("function double(x) {\n    return x * 2;\n}\n\n[1,2,3,4,5].map( double );\n// [2,4,6,8,10]\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("无形参可以提高代码的可读性和可理解性。")]),s._v(" "),t("p",[s._v("其实我们也能看出只有纯函数的组合才能更利于写出无形参风格的代码，看起来更优雅~")]),s._v(" "),t("h2",{attrs:{id:"monad"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#monad"}},[s._v("#")]),s._v(" Monad")]),s._v(" "),t("p",[s._v("前面一直强调：纯函数！无副作用！")]),s._v(" "),t("p",[s._v("谈何容易？HTTP 请求、修改函数外的数据、输出数据到屏幕或控制台、DOM查询/操作、Math.random()、获取当前时间等等这些操作都是我们经常需要做的，根本不可能摈弃它们，不然连最基础功能都实现不了。。。")]),s._v(" "),t("p",[s._v("解决上述矛盾，这里要抛出一个哲学问题：")]),s._v(" "),t("blockquote",[t("p",[s._v("你是否能知道一间黑色的房间里面有没有一只黑色的猫？")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d1c0567d20064cb8b4d673cd2fecaeb8~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),s._v(" "),t("p",[s._v("明显是不能的，直到开灯那一刻之前，把一只猫藏在一间黑色的屋子里，和一间干净的黑屋子都是等效的。")]),s._v(" "),t("p",[s._v("所以，对了！我们可以把不纯的函数用一间间黑色屋子装起来，最后一刻再亮灯，这样能保证在亮灯前一刻，一直都是“纯”的。")]),s._v(" "),t("p",[s._v("这些屋子就是单子 —— “Monad”！")]),s._v(" "),t("p",[s._v("🌰举个例子，用 JavaScript 模拟这个过程：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('var fs = require("fs");\n\n// 纯函数，传入 filename，返回 Monad 对象\nvar readFile = function (filename) {\n  // 副作用函数：读取文件\n  const readFileFn = () => {\n    return fs.readFileSync(filename, "utf-8");\n  };\n  return new Monad(readFileFn);\n};\n\n// 纯函数，传入 x，返回 Monad 对象\nvar print = function (x) {\n  // 副作用函数：打印日志\n  const logFn = () => {\n    console.log(x);\n    return x;\n  };\n  return new Monad(logFn);\n};\n\n// 纯函数，传入 x，返回 Monad 对象\nvar tail = function (x) {\n  // 副作用函数：返回最后一行的数据\n  const tailFn = () => {\n    return x[x.length - 1];\n  };\n  return new Monad(tailFn);\n};\n\n// 链式操作文件\nconst monad = readFile("./xxx.txt").bind(tail).bind(print);\n// 执行到这里，整个操作都是纯的，因为副作用函数一直被包裹在 Monad 里，并没有执行\nmonad.value(); // 执行副作用函数\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br")])]),t("p",[t("code",[s._v("readFile、print、tail")]),s._v(" 函数最开始并非是纯函数，都有副作用操作，比如读文件、打印日志、修改数据，然而经过用 Monad 封装之后，它们可以等效为一个个纯函数，然后通过链式绑定，最后调用执行，也就是开灯。")]),s._v(" "),t("p",[s._v("在执行 "),t("code",[s._v("monad.value()")]),s._v(" 这句之前，整段函数都是“纯”的，都没有对外部环境做任何影响，也就意味着我们最大程度的保证了“纯”这一特性。")]),s._v(" "),t("p",[s._v("王垠在"),t("a",{attrs:{href:"https://link.jianshu.com/?t=http://www.yinwang.org/blog-cn/2013/03/31/purely-functional",target:"_blank",rel:"noopener noreferrer"}},[s._v("《对函数式语言的误解》"),t("OutboundLink")],1),s._v("中准确了描述了 Monad 本质：")]),s._v(" "),t("blockquote",[t("p",[s._v("Monad 本质是使用类型系统的“重载”（overloading），"),t("strong",[s._v("把这些多出来的参数和返回值，掩盖在类型里面。这就像把乱七八糟的电线塞进了接线盒似的")]),s._v("，虽然表面上看起来清爽了一些，底下的复杂性却是不可能消除的。")])]),s._v(" "),t("p",[s._v("上述的 Monad 只是最通俗的理解，实际上 Monad 还有很多分类，比如：Maybe 单子、List 单子、IO 单子、Writer 单子等，后面再讨论~")]),s._v(" "),t("h2",{attrs:{id:"结语"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#结语"}},[s._v("#")]),s._v(" 结语")]),s._v(" "),t("p",[s._v("本篇从纯函数出发，JavaScript 函数要写的优雅，一定要“纯”！写纯函数、组合纯函数、简化运算纯函数、无形参风格、纯函数的链式调用、Monad 封装不存的函数让它看起来“纯”~")]),s._v(" "),t("p",[s._v("纯，就是这个味儿！")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c5d2d6d5154a46498de99387600f0631~tplv-k3u1fbpfcp-watermark.image?",alt:"2016011611024214841.gif"}})]),s._v(" "),t("p",[s._v("OK，以上便是本篇分享，专栏第 3 篇，希望各位工友喜欢~ 欢迎点赞、收藏、评论 🤟")]),s._v(" "),t("p",[s._v("后文会重点讲 延迟处理的思想、JavaScript 迭代器、函数式编程中的异步等，敬请期待~")]),s._v(" "),t("p",[s._v("关注专栏 "),t("a",{attrs:{href:"https://juejin.cn/column/7140154838981017613",title:"https://juejin.cn/column/7140154838981017613",target:"_blank",rel:"noopener noreferrer"}},[s._v("# JavaScript 函数式编程精要 —— 签约作者安东尼"),t("OutboundLink")],1)]),s._v(" "),t("blockquote",[t("p",[s._v("我是掘金安东尼 🤠 100 万人气前端技术博主 💥 INFP 写作人格坚持 1000 日更文 ✍ 关注我，安东尼陪你一起度过漫长编程岁月 🌏")])])])}),[],!1,null,null,null);a.default=e.exports}}]);